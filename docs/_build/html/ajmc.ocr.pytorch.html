<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark">
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link rel="index" title="Index" href="genindex.html"/>
    <link rel="search" title="Search" href="search.html"/>
    <link rel="next" title="ajmc.ocr.tesseract package" href="ajmc.ocr.tesseract.html"/>
    <link rel="prev" title="ajmc.ocr.preprocessing package" href="ajmc.ocr.preprocessing.html"/>

    <!-- Generated with Sphinx 7.2.5 and Furo 2023.08.19 -->
    <title>ajmc.ocr.pytorch package - ajmc v0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c"/>
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=135e06be"/>
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c"/>


    <style>
        body {
            --color-code-background: #f8f8f8;
            --color-code-foreground: black;

        }

        @media not print {
            body[data-theme="dark"] {
                --color-code-background: #202020;
                --color-code-foreground: #d0d0d0;

            }

            @media (prefers-color-scheme: dark) {
                body:not([data-theme="light"]) {
                    --color-code-background: #202020;
                    --color-code-foreground: #d0d0d0;

                }
            }
        }
    </style>
</head>
<body>

<script>
    document.body.dataset.theme = localStorage.getItem("theme") || "auto";
</script>


<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="svg-toc" viewBox="0 0 24 24">
        <title>Contents</title>
        <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
            <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
        </svg>
    </symbol>
    <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
             stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
    </symbol>
    <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
             stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
            <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
    </symbol>
    <symbol id="svg-sun" viewBox="0 0 24 24">
        <title>Light mode</title>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
             stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
        </svg>
    </symbol>
    <symbol id="svg-moon" viewBox="0 0 24 24">
        <title>Dark mode</title>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
             stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"/>
        </svg>
    </symbol>
    <symbol id="svg-sun-half" viewBox="0 0 24 24">
        <title>Auto light/dark mode</title>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
             stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <circle cx="12" cy="12" r="9"/>
            <path d="M13 12h5"/>
            <path d="M13 15h4"/>
            <path d="M13 18h1"/>
            <path d="M13 9h4"/>
            <path d="M13 6h1"/>
        </svg>
    </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
    <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
    <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
    <header class="mobile-header">
        <div class="header-left">
            <label class="nav-overlay-icon" for="__navigation">
                <div class="visually-hidden">Toggle site navigation sidebar</div>
                <i class="icon">
                    <svg>
                        <use href="#svg-menu"></use>
                    </svg>
                </i>
            </label>
        </div>
        <div class="header-center">
            <a href="index.html">
                <div class="brand">ajmc v0.0.1 documentation</div>
            </a>
        </div>
        <div class="header-right">
            <div class="theme-toggle-container theme-toggle-header">
                <button class="theme-toggle">
                    <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
                    <svg class="theme-icon-when-auto">
                        <use href="#svg-sun-half"></use>
                    </svg>
                    <svg class="theme-icon-when-dark">
                        <use href="#svg-moon"></use>
                    </svg>
                    <svg class="theme-icon-when-light">
                        <use href="#svg-sun"></use>
                    </svg>
                </button>
            </div>
            <label class="toc-overlay-icon toc-header-icon" for="__toc">
                <div class="visually-hidden">Toggle table of contents sidebar</div>
                <i class="icon">
                    <svg>
                        <use href="#svg-toc"></use>
                    </svg>
                </i>
            </label>
        </div>
    </header>
    <aside class="sidebar-drawer">
        <div class="sidebar-container">

            <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">


                <span class="sidebar-brand-text">ajmc v0.0.1 documentation</span>

            </a>
                <form class="sidebar-search-container" method="get" action="search.html" role="search">
                    <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
                    <input type="hidden" name="check_keywords" value="yes">
                    <input type="hidden" name="area" value="default">
                </form>
                <div id="searchbox"></div>
                <div class="sidebar-scroll">
                    <div class="sidebar-tree">
                        <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
                        <ul class="current">
                            <li class="toctree-l1 current has-children"><a class="reference internal"
                                                                           href="modules.html">ajmc</a><input checked=""
                                                                                                              class="toctree-checkbox"
                                                                                                              id="toctree-checkbox-1"
                                                                                                              name="toctree-checkbox-1"
                                                                                                              role="switch"
                                                                                                              type="checkbox"/><label
                                    for="toctree-checkbox-1">
                                <div class="visually-hidden">Toggle navigation of ajmc</div>
                                <i class="icon">
                                    <svg>
                                        <use href="#svg-arrow-right"></use>
                                    </svg>
                                </i></label>
                                <ul class="current">
                                    <li class="toctree-l2 current has-children"><a class="reference internal"
                                                                                   href="ajmc.html">ajmc
                                        package</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2"
                                                          name="toctree-checkbox-2" role="switch"
                                                          type="checkbox"/><label for="toctree-checkbox-2">
                                        <div class="visually-hidden">Toggle navigation of ajmc package</div>
                                        <i class="icon">
                                            <svg>
                                                <use href="#svg-arrow-right"></use>
                                            </svg>
                                        </i></label>
                                        <ul class="current">
                                            <li class="toctree-l3"><a class="reference internal"
                                                                      href="ajmc.commons.html">ajmc.commons package</a>
                                            </li>
                                            <li class="toctree-l3"><a class="reference internal"
                                                                      href="ajmc.corpora.html">ajmc.corpora package</a>
                                            </li>
                                            <li class="toctree-l3 has-children"><a class="reference internal"
                                                                                   href="ajmc.nlp.html">ajmc.nlp
                                                package</a><input class="toctree-checkbox" id="toctree-checkbox-3"
                                                                  name="toctree-checkbox-3" role="switch"
                                                                  type="checkbox"/><label for="toctree-checkbox-3">
                                                <div class="visually-hidden">Toggle navigation of ajmc.nlp package</div>
                                                <i class="icon">
                                                    <svg>
                                                        <use href="#svg-arrow-right"></use>
                                                    </svg>
                                                </i></label>
                                                <ul>
                                                    <li class="toctree-l4 has-children"><a class="reference internal"
                                                                                           href="ajmc.nlp.token_classification.html">ajmc.nlp.token_classification
                                                        package</a><input class="toctree-checkbox"
                                                                          id="toctree-checkbox-4"
                                                                          name="toctree-checkbox-4" role="switch"
                                                                          type="checkbox"/><label
                                                            for="toctree-checkbox-4">
                                                        <div class="visually-hidden">Toggle navigation of
                                                            ajmc.nlp.token_classification package
                                                        </div>
                                                        <i class="icon">
                                                            <svg>
                                                                <use href="#svg-arrow-right"></use>
                                                            </svg>
                                                        </i></label>
                                                        <ul>
                                                            <li class="toctree-l5"><a class="reference internal"
                                                                                      href="ajmc.nlp.token_classification.data_preparation.html">ajmc.nlp.token_classification.data_preparation
                                                                package</a></li>
                                                        </ul>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li class="toctree-l3 current has-children"><a class="reference internal"
                                                                                           href="ajmc.ocr.html">ajmc.ocr
                                                package</a><input checked="" class="toctree-checkbox"
                                                                  id="toctree-checkbox-5" name="toctree-checkbox-5"
                                                                  role="switch" type="checkbox"/><label
                                                    for="toctree-checkbox-5">
                                                <div class="visually-hidden">Toggle navigation of ajmc.ocr package</div>
                                                <i class="icon">
                                                    <svg>
                                                        <use href="#svg-arrow-right"></use>
                                                    </svg>
                                                </i></label>
                                                <ul class="current">
                                                    <li class="toctree-l4"><a class="reference internal"
                                                                              href="ajmc.ocr.preprocessing.html">ajmc.ocr.preprocessing
                                                        package</a></li>
                                                    <li class="toctree-l4 current current-page"><a
                                                            class="current reference internal" href="#">ajmc.ocr.pytorch
                                                        package</a></li>
                                                    <li class="toctree-l4"><a class="reference internal"
                                                                              href="ajmc.ocr.tesseract.html">ajmc.ocr.tesseract
                                                        package</a></li>
                                                </ul>
                                            </li>
                                            <li class="toctree-l3 has-children"><a class="reference internal"
                                                                                   href="ajmc.olr.html">ajmc.olr
                                                package</a><input class="toctree-checkbox" id="toctree-checkbox-6"
                                                                  name="toctree-checkbox-6" role="switch"
                                                                  type="checkbox"/><label for="toctree-checkbox-6">
                                                <div class="visually-hidden">Toggle navigation of ajmc.olr package</div>
                                                <i class="icon">
                                                    <svg>
                                                        <use href="#svg-arrow-right"></use>
                                                    </svg>
                                                </i></label>
                                                <ul>
                                                    <li class="toctree-l4"><a class="reference internal"
                                                                              href="ajmc.olr.layoutlm.html">ajmc.olr.layoutlm
                                                        package</a></li>
                                                    <li class="toctree-l4"><a class="reference internal"
                                                                              href="ajmc.olr.yolo.html">ajmc.olr.yolo
                                                        package</a></li>
                                                </ul>
                                            </li>
                                            <li class="toctree-l3"><a class="reference internal"
                                                                      href="ajmc.text_processing.html">ajmc.text_processing
                                                package</a></li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                        <p class="caption" role="heading"><span class="caption-text">Introduction:</span></p>
                        <ul>
                            <li class="toctree-l1"><a class="reference internal"
                                                      href="other_pages/base_functionalities.html">Basic
                                functionalities</a></li>
                            <li class="toctree-l1"><a class="reference internal"
                                                      href="other_pages/commentary_importation_pipeline.html">Commentary
                                importation pipeline</a></li>
                            <li class="toctree-l1"><a class="reference internal"
                                                      href="other_pages/data_organisation.html">Understanding the ajmc
                                directory structure.</a></li>
                        </ul>
                        <p class="caption" role="heading"><span class="caption-text">Contributing:</span></p>
                        <ul>
                            <li class="toctree-l1"><a class="reference internal"
                                                      href="other_pages/introduction_to_code.html">Understanding the
                                goal of the library</a></li>
                            <li class="toctree-l1"><a class="reference internal"
                                                      href="other_pages/introduction_to_code.html#The-commons-directory">The
                                commons directory</a></li>
                            <li class="toctree-l1"><a class="reference internal"
                                                      href="other_pages/introduction_to_code.html#The-text_processing-directory">The
                                <code class="docutils literal notranslate"><span
                                        class="pre">text_processing</span></code> directory</a></li>
                            <li class="toctree-l1"><a class="reference internal"
                                                      href="other_pages/contributing_guidelines.html">Contributing
                                guidelines</a></li>
                        </ul>

                    </div>
                </div>

            </div>

        </div>
    </aside>
    <div class="main">
        <div class="content">
            <div class="article-container">
                <a href="#" class="back-to-top muted-link">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
                    </svg>
                    <span>Back to top</span>
                </a>
                <div class="content-icon-container">

                    <div class="theme-toggle-container theme-toggle-content">
                        <button class="theme-toggle">
                            <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
                            <svg class="theme-icon-when-auto">
                                <use href="#svg-sun-half"></use>
                            </svg>
                            <svg class="theme-icon-when-dark">
                                <use href="#svg-moon"></use>
                            </svg>
                            <svg class="theme-icon-when-light">
                                <use href="#svg-sun"></use>
                            </svg>
                        </button>
                    </div>
                    <label class="toc-overlay-icon toc-content-icon" for="__toc">
                        <div class="visually-hidden">Toggle table of contents sidebar</div>
                        <i class="icon">
                            <svg>
                                <use href="#svg-toc"></use>
                            </svg>
                        </i>
                    </label>
                </div>
                <article role="main">
                    <section id="module-ajmc.ocr.pytorch">
                        <span id="ajmc-ocr-pytorch-package"></span>
                        <h1>ajmc.ocr.pytorch package<a class="headerlink" href="#module-ajmc.ocr.pytorch"
                                                       title="Link to this heading">#</a></h1>
                        <section id="submodules">
                            <h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a>
                            </h2>
                        </section>
                        <section id="module-ajmc.ocr.pytorch.config">
                            <span id="ajmc-ocr-pytorch-config-module"></span>
                            <h2>ajmc.ocr.pytorch.config module<a class="headerlink"
                                                                 href="#module-ajmc.ocr.pytorch.config"
                                                                 title="Link to this heading">#</a></h2>
                            <p>Reads a config file from json and returns a dictionary of the config.</p>
                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.config.get_config">
                                    <span class="sig-prename descclassname"><span
                                            class="pre">ajmc.ocr.pytorch.config.</span></span><span
                                        class="sig-name descname"><span class="pre">get_config</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">config_path</span></span><span class="p"><span class="pre">:</span></span><span
                                        class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em
                                        class="sig-param"><span class="n"><span class="pre">rewrite</span></span><span
                                        class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                        class="n"><span class="pre">bool</span></span><span class="w"> </span><span
                                        class="o"><span class="pre">=</span></span><span class="w"> </span><span
                                        class="default_value"><span class="pre">True</span></span></em><span
                                        class="sig-paren">)</span> <span class="sig-return"><span
                                        class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span
                                        class="pre">dict</span></span></span><a class="reference internal"
                                                                                href="_modules/ajmc/ocr/pytorch/config.html#get_config"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.config.get_config"
                                        title="Link to this definition">#</a></dt>
                                <dd></dd>
                            </dl>

                        </section>
                        <section id="module-ajmc.ocr.pytorch.ctc_decoder_torch">
                            <span id="ajmc-ocr-pytorch-ctc-decoder-torch-module"></span>
                            <h2>ajmc.ocr.pytorch.ctc_decoder_torch module<a class="headerlink"
                                                                            href="#module-ajmc.ocr.pytorch.ctc_decoder_torch"
                                                                            title="Link to this heading">#</a></h2>
                            <dl class="py class">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.ctc_decoder_torch.BeamCTCDecoder">
                                    <em class="property"><span class="pre">class</span><span
                                            class="w"> </span></em><span class="sig-prename descclassname"><span
                                        class="pre">ajmc.ocr.pytorch.ctc_decoder_torch.</span></span><span
                                        class="sig-name descname"><span class="pre">BeamCTCDecoder</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">labels</span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">lm_path</span></span><span class="o"><span
                                        class="pre">=</span></span><span class="default_value"><span
                                        class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span
                                        class="default_value"><span class="pre">0</span></span></em>, <em
                                        class="sig-param"><span class="n"><span class="pre">beta</span></span><span
                                        class="o"><span class="pre">=</span></span><span class="default_value"><span
                                        class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">cutoff_top_n</span></span><span class="o"><span class="pre">=</span></span><span
                                        class="default_value"><span class="pre">40</span></span></em>, <em
                                        class="sig-param"><span class="n"><span
                                        class="pre">cutoff_prob</span></span><span class="o"><span class="pre">=</span></span><span
                                        class="default_value"><span class="pre">1.0</span></span></em>, <em
                                        class="sig-param"><span class="n"><span
                                        class="pre">beam_width</span></span><span class="o"><span
                                        class="pre">=</span></span><span class="default_value"><span
                                        class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">num_processes</span></span><span class="o"><span
                                        class="pre">=</span></span><span class="default_value"><span
                                        class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">blank_index</span></span><span class="o"><span class="pre">=</span></span><span
                                        class="default_value"><span class="pre">0</span></span></em><span
                                        class="sig-paren">)</span><a class="reference internal"
                                                                     href="_modules/ajmc/ocr/pytorch/ctc_decoder_torch.html#BeamCTCDecoder"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.ctc_decoder_torch.BeamCTCDecoder"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Bases: <a class="reference internal"
                                                 href="#ajmc.ocr.pytorch.ctc_decoder_torch.Decoder"
                                                 title="ajmc.ocr.pytorch.ctc_decoder_torch.Decoder"><code
                                        class="xref py py-class docutils literal notranslate"><span
                                        class="pre">Decoder</span></code></a></p>
                                    <dl class="py method">
                                        <dt class="sig sig-object py"
                                            id="ajmc.ocr.pytorch.ctc_decoder_torch.BeamCTCDecoder.convert_tensor">
                                            <span class="sig-name descname"><span
                                                    class="pre">convert_tensor</span></span><span
                                                class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                                class="pre">offsets</span></span></em>, <em class="sig-param"><span
                                                class="n"><span class="pre">sizes</span></span></em><span
                                                class="sig-paren">)</span><a class="reference internal"
                                                                             href="_modules/ajmc/ocr/pytorch/ctc_decoder_torch.html#BeamCTCDecoder.convert_tensor"><span
                                                class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                                class="headerlink"
                                                href="#ajmc.ocr.pytorch.ctc_decoder_torch.BeamCTCDecoder.convert_tensor"
                                                title="Link to this definition">#</a></dt>
                                        <dd></dd>
                                    </dl>

                                    <dl class="py method">
                                        <dt class="sig sig-object py"
                                            id="ajmc.ocr.pytorch.ctc_decoder_torch.BeamCTCDecoder.convert_to_strings">
                                            <span class="sig-name descname"><span class="pre">convert_to_strings</span></span><span
                                                class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                                class="pre">out</span></span></em>, <em class="sig-param"><span
                                                class="n"><span class="pre">seq_len</span></span></em><span
                                                class="sig-paren">)</span><a class="reference internal"
                                                                             href="_modules/ajmc/ocr/pytorch/ctc_decoder_torch.html#BeamCTCDecoder.convert_to_strings"><span
                                                class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                                class="headerlink"
                                                href="#ajmc.ocr.pytorch.ctc_decoder_torch.BeamCTCDecoder.convert_to_strings"
                                                title="Link to this definition">#</a></dt>
                                        <dd></dd>
                                    </dl>

                                    <dl class="py method">
                                        <dt class="sig sig-object py"
                                            id="ajmc.ocr.pytorch.ctc_decoder_torch.BeamCTCDecoder.decode">
                                            <span class="sig-name descname"><span class="pre">decode</span></span><span
                                                class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                                class="pre">probs</span></span></em>, <em class="sig-param"><span
                                                class="n"><span class="pre">sizes</span></span><span class="o"><span
                                                class="pre">=</span></span><span class="default_value"><span
                                                class="pre">None</span></span></em><span class="sig-paren">)</span><a
                                                class="reference internal"
                                                href="_modules/ajmc/ocr/pytorch/ctc_decoder_torch.html#BeamCTCDecoder.decode"><span
                                                class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                                class="headerlink"
                                                href="#ajmc.ocr.pytorch.ctc_decoder_torch.BeamCTCDecoder.decode"
                                                title="Link to this definition">#</a></dt>
                                        <dd><p>Decodes probability output using ctcdecode package.</p>
                                            <dl class="field-list simple">
                                                <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                                <dd class="field-odd">
                                                    <ul class="simple">
                                                        <li><p><strong>probs</strong> – Tensor of character
                                                            probabilities, where probs[c,t] is the probability of
                                                            character c at time t</p></li>
                                                        <li><p><strong>sizes</strong> – Size of each sequence in the
                                                            mini-batch</p></li>
                                                    </ul>
                                                </dd>
                                                <dt class="field-even">Returns<span class="colon">:</span></dt>
                                                <dd class="field-even"><p>sequences of the model’s best guess for the
                                                    transcription</p>
                                                </dd>
                                                <dt class="field-odd">Return type<span class="colon">:</span></dt>
                                                <dd class="field-odd"><p>string</p>
                                                </dd>
                                            </dl>
                                        </dd>
                                    </dl>

                                </dd>
                            </dl>

                            <dl class="py class">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.ctc_decoder_torch.Decoder">
                                    <em class="property"><span class="pre">class</span><span
                                            class="w"> </span></em><span class="sig-prename descclassname"><span
                                        class="pre">ajmc.ocr.pytorch.ctc_decoder_torch.</span></span><span
                                        class="sig-name descname"><span class="pre">Decoder</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">labels</span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">blank_index</span></span><span class="o"><span
                                        class="pre">=</span></span><span class="default_value"><span
                                        class="pre">0</span></span></em><span class="sig-paren">)</span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/ctc_decoder_torch.html#Decoder"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.ctc_decoder_torch.Decoder"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span
                                        class="pre">object</span></code></p>
                                    <p>Basic decoder class from which all other decoders inherit. Implements several
                                        helper functions. Subclasses should implement the decode() method.</p>
                                    <dl class="field-list simple">
                                        <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                        <dd class="field-odd">
                                            <ul class="simple">
                                                <li><p><strong>labels</strong> (<em>list</em>) – mapping from integers
                                                    to characters.</p></li>
                                                <li><p><strong>blank_index</strong>
                                                    (<em>int</em><em>, </em><em>optional</em>) – index for the blank ‘_’
                                                    character. Defaults to 0.</p></li>
                                            </ul>
                                        </dd>
                                    </dl>
                                    <dl class="py method">
                                        <dt class="sig sig-object py"
                                            id="ajmc.ocr.pytorch.ctc_decoder_torch.Decoder.decode">
                                            <span class="sig-name descname"><span class="pre">decode</span></span><span
                                                class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                                class="pre">probs</span></span></em>, <em class="sig-param"><span
                                                class="n"><span class="pre">sizes</span></span><span class="o"><span
                                                class="pre">=</span></span><span class="default_value"><span
                                                class="pre">None</span></span></em><span class="sig-paren">)</span><a
                                                class="reference internal"
                                                href="_modules/ajmc/ocr/pytorch/ctc_decoder_torch.html#Decoder.decode"><span
                                                class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                                class="headerlink"
                                                href="#ajmc.ocr.pytorch.ctc_decoder_torch.Decoder.decode"
                                                title="Link to this definition">#</a></dt>
                                        <dd><p>Given a matrix of character probabilities, returns the decoder’s
                                            best guess of the transcription</p>
                                            <dl class="field-list simple">
                                                <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                                <dd class="field-odd">
                                                    <ul class="simple">
                                                        <li><p><strong>probs</strong> – Tensor of character
                                                            probabilities, where probs[c,t]
                                                            is the probability of character c at time t</p></li>
                                                        <li><p><strong>sizes</strong> (<em>optional</em>) – Size of each
                                                            sequence in the mini-batch</p></li>
                                                    </ul>
                                                </dd>
                                                <dt class="field-even">Returns<span class="colon">:</span></dt>
                                                <dd class="field-even"><p>sequence of the model’s best guess for the
                                                    transcription</p>
                                                </dd>
                                                <dt class="field-odd">Return type<span class="colon">:</span></dt>
                                                <dd class="field-odd"><p>string</p>
                                                </dd>
                                            </dl>
                                        </dd>
                                    </dl>

                                </dd>
                            </dl>

                            <dl class="py class">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.ctc_decoder_torch.GreedyDecoder">
                                    <em class="property"><span class="pre">class</span><span
                                            class="w"> </span></em><span class="sig-prename descclassname"><span
                                        class="pre">ajmc.ocr.pytorch.ctc_decoder_torch.</span></span><span
                                        class="sig-name descname"><span class="pre">GreedyDecoder</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">labels</span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">blank_index</span></span><span class="o"><span
                                        class="pre">=</span></span><span class="default_value"><span
                                        class="pre">0</span></span></em><span class="sig-paren">)</span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/ctc_decoder_torch.html#GreedyDecoder"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.ctc_decoder_torch.GreedyDecoder"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Bases: <a class="reference internal"
                                                 href="#ajmc.ocr.pytorch.ctc_decoder_torch.Decoder"
                                                 title="ajmc.ocr.pytorch.ctc_decoder_torch.Decoder"><code
                                        class="xref py py-class docutils literal notranslate"><span
                                        class="pre">Decoder</span></code></a></p>
                                    <dl class="py method">
                                        <dt class="sig sig-object py"
                                            id="ajmc.ocr.pytorch.ctc_decoder_torch.GreedyDecoder.convert_to_strings">
                                            <span class="sig-name descname"><span class="pre">convert_to_strings</span></span><span
                                                class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                                class="pre">sequences</span></span></em>, <em class="sig-param"><span
                                                class="n"><span class="pre">sizes</span></span><span class="o"><span
                                                class="pre">=</span></span><span class="default_value"><span
                                                class="pre">None</span></span></em>, <em class="sig-param"><span
                                                class="n"><span class="pre">remove_repetitions</span></span><span
                                                class="o"><span class="pre">=</span></span><span
                                                class="default_value"><span class="pre">False</span></span></em>, <em
                                                class="sig-param"><span class="n"><span
                                                class="pre">return_offsets</span></span><span class="o"><span
                                                class="pre">=</span></span><span class="default_value"><span
                                                class="pre">False</span></span></em><span class="sig-paren">)</span><a
                                                class="reference internal"
                                                href="_modules/ajmc/ocr/pytorch/ctc_decoder_torch.html#GreedyDecoder.convert_to_strings"><span
                                                class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                                class="headerlink"
                                                href="#ajmc.ocr.pytorch.ctc_decoder_torch.GreedyDecoder.convert_to_strings"
                                                title="Link to this definition">#</a></dt>
                                        <dd><p>Given a list of numeric sequences, returns the corresponding strings</p>
                                        </dd>
                                    </dl>

                                    <dl class="py method">
                                        <dt class="sig sig-object py"
                                            id="ajmc.ocr.pytorch.ctc_decoder_torch.GreedyDecoder.decode">
                                            <span class="sig-name descname"><span class="pre">decode</span></span><span
                                                class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                                class="pre">probs</span></span></em>, <em class="sig-param"><span
                                                class="n"><span class="pre">sizes</span></span><span class="o"><span
                                                class="pre">=</span></span><span class="default_value"><span
                                                class="pre">None</span></span></em><span class="sig-paren">)</span><a
                                                class="reference internal"
                                                href="_modules/ajmc/ocr/pytorch/ctc_decoder_torch.html#GreedyDecoder.decode"><span
                                                class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                                class="headerlink"
                                                href="#ajmc.ocr.pytorch.ctc_decoder_torch.GreedyDecoder.decode"
                                                title="Link to this definition">#</a></dt>
                                        <dd><p>Returns the argmax decoding given the probability matrix. Removes
                                            repeated elements in the sequence, as well as blanks.</p>
                                            <dl class="field-list simple">
                                                <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                                <dd class="field-odd">
                                                    <ul class="simple">
                                                        <li><p><strong>probs</strong> – Tensor of character
                                                            probabilities from the network. Expected shape of batch x
                                                            seq_length x output_dim</p></li>
                                                        <li><p><strong>sizes</strong> (<em>optional</em>) – Size of each
                                                            sequence in the mini-batch</p></li>
                                                    </ul>
                                                </dd>
                                                <dt class="field-even">Returns<span class="colon">:</span></dt>
                                                <dd class="field-even"><p>sequences of the model’s best guess for the
                                                    transcription on inputs
                                                    offsets: time step per character predicted</p>
                                                </dd>
                                                <dt class="field-odd">Return type<span class="colon">:</span></dt>
                                                <dd class="field-odd"><p>strings</p>
                                                </dd>
                                            </dl>
                                        </dd>
                                    </dl>

                                    <dl class="py method">
                                        <dt class="sig sig-object py"
                                            id="ajmc.ocr.pytorch.ctc_decoder_torch.GreedyDecoder.process_string">
                                            <span class="sig-name descname"><span
                                                    class="pre">process_string</span></span><span
                                                class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                                class="pre">sequence</span></span></em>, <em class="sig-param"><span
                                                class="n"><span class="pre">size</span></span></em>, <em
                                                class="sig-param"><span class="n"><span class="pre">remove_repetitions=False)</span> <span
                                                class="pre">-&gt;</span> <span class="pre">(&lt;class</span> <span
                                                class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span
                                                class="n"><span class="pre">torch.tensor</span></span></em><span
                                                class="sig-paren">)</span><a class="reference internal"
                                                                             href="_modules/ajmc/ocr/pytorch/ctc_decoder_torch.html#GreedyDecoder.process_string"><span
                                                class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                                class="headerlink"
                                                href="#ajmc.ocr.pytorch.ctc_decoder_torch.GreedyDecoder.process_string"
                                                title="Link to this definition">#</a></dt>
                                        <dd></dd>
                                    </dl>

                                </dd>
                            </dl>

                        </section>
                        <section id="module-ajmc.ocr.pytorch.data_generation">
                            <span id="ajmc-ocr-pytorch-data-generation-module"></span>
                            <h2>ajmc.ocr.pytorch.data_generation module<a class="headerlink"
                                                                          href="#module-ajmc.ocr.pytorch.data_generation"
                                                                          title="Link to this heading">#</a></h2>
                            <p>This scripts contains function for generating synthetic data. <code
                                    class="docutils literal notranslate"><span class="pre">pil2array</span></code>,
                                <code class="docutils literal notranslate"><span class="pre">array2pil</span></code>,
                                <code class="docutils literal notranslate"><span
                                        class="pre">ocropy_degrade</span></code>, <code
                                        class="docutils literal notranslate"><span
                                        class="pre">degrade_line</span></code> and <code
                                        class="docutils literal notranslate"><span
                                        class="pre">distort_line</span></code> are directly copied from kraken to avoid
                                import issues.</p>
                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_generation.array2pil">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_generation.</span></span><span
                                        class="sig-name descname"><span class="pre">array2pil</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">a</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span
                                        class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                        class="sig-return-typehint"><span class="pre">Image</span></span></span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/data_generation.html#array2pil"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_generation.array2pil"
                                        title="Link to this definition">#</a></dt>
                                <dd></dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_generation.check_file_count">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_generation.</span></span><span
                                        class="sig-name descname"><span class="pre">check_file_count</span></span><span
                                        class="sig-paren">(</span><span class="sig-paren">)</span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/data_generation.html#check_file_count"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_generation.check_file_count"
                                        title="Link to this definition">#</a></dt>
                                <dd></dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_generation.create_sample_dir">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_generation.</span></span><span
                                        class="sig-name descname"><span class="pre">create_sample_dir</span></span><span
                                        class="sig-paren">(</span><span class="sig-paren">)</span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/data_generation.html#create_sample_dir"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_generation.create_sample_dir"
                                        title="Link to this definition">#</a></dt>
                                <dd></dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_generation.degrade_line">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_generation.</span></span><span
                                        class="sig-name descname"><span class="pre">degrade_line</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">im</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">eta</span></span><span class="o"><span
                                        class="pre">=</span></span><span class="default_value"><span
                                        class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span
                                        class="default_value"><span class="pre">1.5</span></span></em>, <em
                                        class="sig-param"><span class="n"><span class="pre">beta</span></span><span
                                        class="o"><span class="pre">=</span></span><span class="default_value"><span
                                        class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">alpha_0</span></span><span class="o"><span
                                        class="pre">=</span></span><span class="default_value"><span
                                        class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">beta_0</span></span><span class="o"><span
                                        class="pre">=</span></span><span class="default_value"><span
                                        class="pre">1.0</span></span></em><span class="sig-paren">)</span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/data_generation.html#degrade_line"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_generation.degrade_line"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Degrades a line image by adding noise.</p>
                                    <p>For parameter meanings consult “A statistical, nonparametric methodology for
                                        document degradation model validation” (2000) by Tanugo et al.</p>
                                    <dl class="field-list simple">
                                        <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                        <dd class="field-odd">
                                            <ul class="simple">
                                                <li><p><strong>im</strong> (<em>PIL.Image</em>) – Input image</p></li>
                                                <li><p><strong>eta</strong> (<em>float</em>) – Between 0 and 1. And
                                                    jitters to image. Recommend staying to max 0.05</p></li>
                                                <li><p><strong>alpha</strong> (<em>float</em>) – Seems to be the
                                                    concentration of the noise around letters. The higher the more
                                                    concentrated.Go between 0.1 and 3.</p></li>
                                                <li><p><strong>beta</strong> (<em>float</em>) – the amount of holes in
                                                    letters. Try a few 0.1, 0.3 and default.</p></li>
                                                <li><p><strong>alpha_0</strong> (<em>float</em>) – No clue what these
                                                    do, leave default or see paper.</p></li>
                                                <li><p><strong>beta_0</strong> (<em>float</em>) – No clue what these do,
                                                    leave default or see paper.</p></li>
                                            </ul>
                                        </dd>
                                        <dt class="field-even">Returns<span class="colon">:</span></dt>
                                        <dd class="field-even"><p>PIL.Image in mode ‘1’</p>
                                        </dd>
                                    </dl>
                                </dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_generation.distort_line">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_generation.</span></span><span
                                        class="sig-name descname"><span class="pre">distort_line</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">im</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">distort</span></span><span class="o"><span
                                        class="pre">=</span></span><span class="default_value"><span
                                        class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span
                                        class="default_value"><span class="pre">10</span></span></em>, <em
                                        class="sig-param"><span class="n"><span class="pre">eps</span></span><span
                                        class="o"><span class="pre">=</span></span><span class="default_value"><span
                                        class="pre">0.03</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span
                                        class="default_value"><span class="pre">0.3</span></span></em><span
                                        class="sig-paren">)</span><a class="reference internal"
                                                                     href="_modules/ajmc/ocr/pytorch/data_generation.html#distort_line"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_generation.distort_line"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Distorts a line image.</p>
                                    <p>Run BEFORE degrade_line as a white border of 5 pixels will be added.</p>
                                    <dl class="field-list simple">
                                        <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                        <dd class="field-odd">
                                            <ul class="simple">
                                                <li><p><strong>im</strong> (<em>PIL.Image</em>) – Input image</p></li>
                                                <li><p><strong>distort</strong> (<em>float</em>) – Distorting of the
                                                    image set between 1.5 and 4.0, with majority around 2.5</p></li>
                                                <li><p><strong>sigma</strong> (<em>float</em>) – distorting of the
                                                    strokes, set between 0.5, 1.5 for 5% of image, else default</p></li>
                                                <li><p><strong>eps</strong> (<em>float</em>) – set default to 80%, else
                                                    random between 0.01 and 0.1</p></li>
                                                <li><p><strong>delta</strong> (<em>float</em>) – </p></li>
                                            </ul>
                                        </dd>
                                        <dt class="field-even">Returns<span class="colon">:</span></dt>
                                        <dd class="field-even"><p>PIL.Image in mode ‘L’</p>
                                        </dd>
                                    </dl>
                                </dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py"
                                    id="ajmc.ocr.pytorch.data_generation.do_all_purpose_fonts">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_generation.</span></span><span
                                        class="sig-name descname"><span
                                        class="pre">do_all_purpose_fonts</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">line_count_per_font</span></span><span class="o"><span
                                        class="pre">=</span></span><span class="default_value"><span
                                        class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">add_numbers</span></span><span class="o"><span class="pre">=</span></span><span
                                        class="default_value"><span class="pre">True</span></span></em><span
                                        class="sig-paren">)</span><a class="reference internal"
                                                                     href="_modules/ajmc/ocr/pytorch/data_generation.html#do_all_purpose_fonts"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_generation.do_all_purpose_fonts"
                                        title="Link to this definition">#</a></dt>
                                <dd></dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_generation.do_capitals">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_generation.</span></span><span
                                        class="sig-name descname"><span class="pre">do_capitals</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">line_count_per_font</span></span><span class="o"><span
                                        class="pre">=</span></span><span class="default_value"><span
                                        class="pre">200</span></span></em><span class="sig-paren">)</span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/data_generation.html#do_capitals"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_generation.do_capitals"
                                        title="Link to this definition">#</a></dt>
                                <dd></dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_generation.do_gibberish">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_generation.</span></span><span
                                        class="sig-name descname"><span class="pre">do_gibberish</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">line_count_per_font</span></span><span class="o"><span
                                        class="pre">=</span></span><span class="default_value"><span
                                        class="pre">5</span></span></em><span class="sig-paren">)</span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/data_generation.html#do_gibberish"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_generation.do_gibberish"
                                        title="Link to this definition">#</a></dt>
                                <dd></dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_generation.do_greek_fonts">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_generation.</span></span><span
                                        class="sig-name descname"><span class="pre">do_greek_fonts</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">line_count_per_font</span></span><span class="o"><span
                                        class="pre">=</span></span><span class="default_value"><span
                                        class="pre">500</span></span></em><span class="sig-paren">)</span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/data_generation.html#do_greek_fonts"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_generation.do_greek_fonts"
                                        title="Link to this definition">#</a></dt>
                                <dd></dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_generation.do_latin_fonts">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_generation.</span></span><span
                                        class="sig-name descname"><span class="pre">do_latin_fonts</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">line_count_per_font</span></span><span class="o"><span
                                        class="pre">=</span></span><span class="default_value"><span
                                        class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">add_numbers</span></span><span class="o"><span class="pre">=</span></span><span
                                        class="default_value"><span class="pre">True</span></span></em><span
                                        class="sig-paren">)</span><a class="reference internal"
                                                                     href="_modules/ajmc/ocr/pytorch/data_generation.html#do_latin_fonts"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_generation.do_latin_fonts"
                                        title="Link to this definition">#</a></dt>
                                <dd></dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_generation.do_mixed_fonts">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_generation.</span></span><span
                                        class="sig-name descname"><span class="pre">do_mixed_fonts</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">line_count_per_font</span></span><span class="o"><span
                                        class="pre">=</span></span><span class="default_value"><span
                                        class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">add_numbers</span></span><span class="o"><span class="pre">=</span></span><span
                                        class="default_value"><span class="pre">True</span></span></em><span
                                        class="sig-paren">)</span><a class="reference internal"
                                                                     href="_modules/ajmc/ocr/pytorch/data_generation.html#do_mixed_fonts"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_generation.do_mixed_fonts"
                                        title="Link to this definition">#</a></dt>
                                <dd></dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_generation.draw_textline">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_generation.</span></span><span
                                        class="sig-name descname"><span class="pre">draw_textline</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">textline</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">fonts</span></span><span class="p"><span class="pre">:</span></span><span
                                        class="w"> </span><span class="n"><span class="pre">Dict</span><span
                                        class="p"><span class="pre">[</span></span><span class="pre">str</span><span
                                        class="p"><span class="pre">,</span></span><span class="w"> </span><a
                                        class="reference internal" href="ajmc.ocr.html#ajmc.ocr.font_utils.Font"
                                        title="ajmc.ocr.font_utils.Font"><span class="pre">Font</span></a><span
                                        class="p"><span class="pre">]</span></span></span></em>, <em
                                        class="sig-param"><span class="n"><span class="pre">fallback_fonts</span></span><span
                                        class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                        class="n"><span class="pre">List</span><span class="p"><span
                                        class="pre">[</span></span><a class="reference internal"
                                                                      href="ajmc.ocr.html#ajmc.ocr.font_utils.Font"
                                                                      title="ajmc.ocr.font_utils.Font"><span
                                        class="pre">Font</span></a><span class="p"><span
                                        class="pre">]</span></span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">target_height</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">font_variants</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">List</span><span class="p"><span class="pre">[</span></span><span
                                        class="pre">str</span><span class="p"><span
                                        class="pre">]</span></span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">kerning</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">int</span></span><span class="w"> </span><span class="o"><span
                                        class="pre">=</span></span><span class="w"> </span><span
                                        class="default_value"><span class="pre">0</span></span></em>, <em
                                        class="sig-param"><span class="n"><span
                                        class="pre">default_charset</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">str</span></span><span class="w"> </span><span class="o"><span
                                        class="pre">=</span></span><span class="w"> </span><span
                                        class="default_value"><span class="pre">'latin'</span></span></em>, <em
                                        class="sig-param"><span class="n"><span
                                        class="pre">output_file</span></span><span class="p"><span class="pre">:</span></span><span
                                        class="w"> </span><span class="n"><span class="pre">Path</span><span
                                        class="w"> </span><span class="p"><span class="pre">|</span></span><span
                                        class="w"> </span><span class="pre">None</span></span><span
                                        class="w"> </span><span class="o"><span class="pre">=</span></span><span
                                        class="w"> </span><span class="default_value"><span
                                        class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">show_image</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">bool</span></span><span class="w"> </span><span class="o"><span
                                        class="pre">=</span></span><span class="w"> </span><span
                                        class="default_value"><span class="pre">False</span></span></em><span
                                        class="sig-paren">)</span> <span class="sig-return"><span
                                        class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span
                                        class="pre">&lt;module</span> <span class="pre">'PIL.Image'</span> <span
                                        class="pre">from</span> <span class="pre">'/Users/sven/opt/anaconda3/envs/ajmc/lib/python3.11/site-packages/PIL/Image.py'&gt;</span></span></span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/data_generation.html#draw_textline"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_generation.draw_textline"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Draws a textline using the given fonts.</p>
                                    <dl class="field-list simple">
                                        <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                        <dd class="field-odd">
                                            <ul class="simple">
                                                <li><p><strong>textline</strong> (<em>str</em>) – The text to draw.</p>
                                                </li>
                                                <li><p><strong>fonts</strong> (<em>dict</em>) – A dictionary of fonts,
                                                    keyed by charset:
                                                    <cite>{‘latin’: ajmc.ocr.font_utils.Font,
                                                        ‘greek’: ajmc.ocr.font_utils.Font,
                                                        ‘numeral’: ajmc.ocr.font_utils.Font,
                                                        ‘punctuation’: ajmc.ocr.font_utils.Font,
                                                        ‘fallback’: [ajmc.ocr.font_utils.Font]}</cite>.
                                                    Notice that <code class="docutils literal notranslate"><span
                                                            class="pre">'fallback'</span></code> must be a list of <code
                                                            class="docutils literal notranslate"><span
                                                            class="pre">Font</span></code>.</p></li>
                                                <li><p><strong>fallback_fonts</strong> (<em>list</em>) – A list of
                                                    fallback fonts to use when a can’t be printed with the main font.
                                                </p></li>
                                                <li><p><strong>target_height</strong> (<em>int</em>) – The desired
                                                    height of the output image, in pixels.</p></li>
                                                <li><p><strong>font_variants</strong> (<em>list</em>) – A list of size
                                                    len(text) containing the font variant to use for each character,
                                                    eg. <code class="docutils literal notranslate"><span class="pre">['Regular',</span>
                                                        <span class="pre">'Bold',</span> <span
                                                                class="pre">'Italic',</span> <span class="pre">'Regular']</span></code>.
                                                </p></li>
                                                <li><p><strong>kerning</strong> (<em>int</em>) – The kerning to apply to
                                                    the text, in pixels.</p></li>
                                                <li><p><strong>default_charset</strong> (<em>str</em>) – The default
                                                    font to use when a character doesn’t belong to any charset.</p></li>
                                                <li><p><strong>output_file</strong> (<em>Path</em>) – The path to save
                                                    the image to.</p></li>
                                                <li><p><strong>show_image</strong> (<em>bool</em>) – Whether to show the
                                                    image.</p></li>
                                            </ul>
                                        </dd>
                                    </dl>
                                </dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py"
                                    id="ajmc.ocr.pytorch.data_generation.get_textline_font_variants">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_generation.</span></span><span
                                        class="sig-name descname"><span
                                        class="pre">get_textline_font_variants</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">textline</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">default_variant</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">str</span></span><span class="w"> </span><span class="o"><span
                                        class="pre">=</span></span><span class="w"> </span><span
                                        class="default_value"><span class="pre">'Regular'</span></span></em><span
                                        class="sig-paren">)</span> <span class="sig-return"><span
                                        class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span
                                        class="pre">List</span><span class="p"><span class="pre">[</span></span><span
                                        class="pre">str</span><span class="p"><span
                                        class="pre">]</span></span></span></span><a class="reference internal"
                                                                                    href="_modules/ajmc/ocr/pytorch/data_generation.html#get_textline_font_variants"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink"
                                        href="#ajmc.ocr.pytorch.data_generation.get_textline_font_variants"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>A very custom function to generate font variants for a textline.</p>
                                    <dl class="field-list simple">
                                        <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                        <dd class="field-odd">
                                            <ul class="simple">
                                                <li><p><strong>textline</strong> (<em>str</em>) – The textline to
                                                    generate font variants for.</p></li>
                                                <li><p><strong>default_variant</strong> (<em>str</em><em>, </em><em>optional</em>)
                                                    – The default font variant to use. Defaults to ‘Regular’.</p></li>
                                            </ul>
                                        </dd>
                                        <dt class="field-even">Returns<span class="colon">:</span></dt>
                                        <dd class="field-even"><p>A list of font variants, one for each character in the
                                            textline.</p>
                                        </dd>
                                        <dt class="field-odd">Return type<span class="colon">:</span></dt>
                                        <dd class="field-odd"><p>List[str]</p>
                                        </dd>
                                    </dl>
                                </dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py"
                                    id="ajmc.ocr.pytorch.data_generation.get_textline_generators">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_generation.</span></span><span
                                        class="sig-name descname"><span
                                        class="pre">get_textline_generators</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">corpus_ids</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">List</span><span class="p"><span class="pre">[</span></span><span
                                        class="pre">str</span><span class="p"><span
                                        class="pre">]</span></span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">line_length_distribution</span></span><span
                                        class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                        class="n"><span class="pre">Dict</span><span class="p"><span
                                        class="pre">[</span></span><span class="pre">int</span><span class="p"><span
                                        class="pre">,</span></span><span class="w"> </span><span
                                        class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span
                                        class="sig-paren">)</span> <span class="sig-return"><span
                                        class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span
                                        class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span
                                        class="pre">str</span><span class="p"><span class="pre">,</span></span><span
                                        class="w"> </span><span class="pre">Generator</span><span class="p"><span
                                        class="pre">[</span></span><span class="pre">str</span><span class="p"><span
                                        class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span
                                        class="p"><span class="pre">,</span></span><span class="w"> </span><span
                                        class="pre">None</span><span class="p"><span class="pre">]</span></span><span
                                        class="p"><span class="pre">]</span></span></span></span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/data_generation.html#get_textline_generators"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink"
                                        href="#ajmc.ocr.pytorch.data_generation.get_textline_generators"
                                        title="Link to this definition">#</a></dt>
                                <dd></dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_generation.inner_loop">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_generation.</span></span><span
                                        class="sig-name descname"><span class="pre">inner_loop</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">line_count_per_font</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">fonts</span></span><span class="p"><span class="pre">:</span></span><span
                                        class="w"> </span><span class="n"><span class="pre">Dict</span><span
                                        class="p"><span class="pre">[</span></span><span class="pre">str</span><span
                                        class="p"><span class="pre">,</span></span><span class="w"> </span><a
                                        class="reference internal" href="ajmc.ocr.html#ajmc.ocr.font_utils.Font"
                                        title="ajmc.ocr.font_utils.Font"><span class="pre">Font</span></a><span
                                        class="p"><span class="pre">]</span></span></span></em>, <em
                                        class="sig-param"><span class="n"><span class="pre">fallback_fonts</span></span><span
                                        class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                        class="n"><span class="pre">List</span><span class="p"><span
                                        class="pre">[</span></span><a class="reference internal"
                                                                      href="ajmc.ocr.html#ajmc.ocr.font_utils.Font"
                                                                      title="ajmc.ocr.font_utils.Font"><span
                                        class="pre">Font</span></a><span class="p"><span
                                        class="pre">]</span></span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">textline_generators</span></span><span
                                        class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                        class="n"><span class="pre">Dict</span><span class="p"><span
                                        class="pre">[</span></span><span class="pre">str</span><span class="p"><span
                                        class="pre">,</span></span><span class="w"> </span><span
                                        class="pre">Generator</span><span class="p"><span
                                        class="pre">[</span></span><span class="pre">str</span><span class="p"><span
                                        class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span
                                        class="p"><span class="pre">,</span></span><span class="w"> </span><span
                                        class="pre">None</span><span class="p"><span class="pre">]</span></span><span
                                        class="p"><span class="pre">]</span></span></span></em>, <em
                                        class="sig-param"><span class="n"><span
                                        class="pre">fonts_distribution</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span
                                        class="pre">str</span><span class="p"><span class="pre">,</span></span><span
                                        class="w"> </span><span class="pre">float</span><span class="p"><span
                                        class="pre">]</span></span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">kerning_distribution</span></span><span
                                        class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                        class="n"><span class="pre">Dict</span><span class="p"><span
                                        class="pre">[</span></span><span class="pre">int</span><span class="p"><span
                                        class="pre">,</span></span><span class="w"> </span><span
                                        class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>,
                                    <em class="sig-param"><span class="n"><span
                                            class="pre">target_height</span></span><span class="p"><span
                                            class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                            class="pre">int</span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">output_dir</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">charset</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span
                                        class="w"> </span><span class="pre">None</span></span><span
                                        class="w"> </span><span class="o"><span class="pre">=</span></span><span
                                        class="w"> </span><span class="default_value"><span
                                        class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">mixed_charsets</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span
                                        class="pre">str</span><span class="p"><span class="pre">,</span></span><span
                                        class="w"> </span><span class="pre">float</span><span class="p"><span
                                        class="pre">]</span></span><span class="w"> </span><span class="p"><span
                                        class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span
                                        class="w"> </span><span class="o"><span class="pre">=</span></span><span
                                        class="w"> </span><span class="default_value"><span
                                        class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">base_font_charset</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">str</span></span><span class="w"> </span><span class="o"><span
                                        class="pre">=</span></span><span class="w"> </span><span
                                        class="default_value"><span class="pre">'latin'</span></span></em>, <em
                                        class="sig-param"><span class="n"><span
                                        class="pre">capitalize</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">bool</span></span><span class="w"> </span><span class="o"><span
                                        class="pre">=</span></span><span class="w"> </span><span
                                        class="default_value"><span class="pre">False</span></span></em>, <em
                                        class="sig-param"><span class="n"><span
                                        class="pre">add_numbers</span></span><span class="p"><span class="pre">:</span></span><span
                                        class="w"> </span><span class="n"><span class="pre">bool</span></span><span
                                        class="w"> </span><span class="o"><span class="pre">=</span></span><span
                                        class="w"> </span><span class="default_value"><span
                                        class="pre">False</span></span></em><span class="sig-paren">)</span> <span
                                        class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                        class="sig-return-typehint"><span class="pre">None</span></span></span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/data_generation.html#inner_loop"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_generation.inner_loop"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Inner loop of the script.</p>
                                </dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_generation.pad_image">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_generation.</span></span><span
                                        class="sig-name descname"><span class="pre">pad_image</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="pre">image:</span>
                                    <span class="pre">&lt;module</span> <span class="pre">'PIL.Image'</span> <span
                                            class="pre">from</span> <span class="pre">'/Users/sven/opt/anaconda3/envs/ajmc/lib/python3.11/site-packages/PIL/Image.py'&gt;,</span>
                                    <span class="pre">padding:</span> <span class="pre">~typing.Tuple[int,</span> <span
                                            class="pre">int,</span> <span class="pre">int,</span> <span class="pre">int],</span>
                                    <span class="pre">target_height:</span> <span class="pre">int</span> <span
                                            class="pre">|</span> <span class="pre">None</span> <span
                                            class="pre">=</span> <span class="pre">None,</span> <span class="pre">background_color:</span>
                                    <span class="pre">str</span> <span class="pre">=</span> <span
                                            class="pre">'black'</span></em><span class="sig-paren">)</span> <span
                                        class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                        class="sig-return-typehint"><span class="pre">&lt;module</span> <span
                                        class="pre">'PIL.Image'</span> <span class="pre">from</span> <span class="pre">'/Users/sven/opt/anaconda3/envs/ajmc/lib/python3.11/site-packages/PIL/Image.py'&gt;</span></span></span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/data_generation.html#pad_image"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_generation.pad_image"
                                        title="Link to this definition">#</a></dt>
                                <dd>
                                    <dl class="field-list simple">
                                        <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                        <dd class="field-odd">
                                            <ul class="simple">
                                                <li><p><strong>image</strong> (<em>PILImage</em>) – The image to pad.
                                                </p></li>
                                                <li><p><strong>padding</strong> (<em>tuple</em>) – The padding to apply,
                                                    in the form (top, right, bottom, left).</p></li>
                                                <li><p><strong>target_height</strong> (<em>int</em>) – The desired
                                                    height of the output image, in pixels.</p></li>
                                                <li><p><strong>specified</strong> (<em>If</em>) – </p></li>
                                                <li><p><strong>padding.</strong> (<em>image will be resized so that its
                                                    height is target_height after</em>) – </p></li>
                                                <li><p><strong>background_color</strong> (<em>str</em>) – The color of
                                                    the background.</p></li>
                                            </ul>
                                        </dd>
                                        <dt class="field-even">Returns<span class="colon">:</span></dt>
                                        <dd class="field-even"><p>The padded image.</p>
                                        </dd>
                                        <dt class="field-odd">Return type<span class="colon">:</span></dt>
                                        <dd class="field-odd"><p>PILImage</p>
                                        </dd>
                                    </dl>
                                </dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_generation.pil2array">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_generation.</span></span><span
                                        class="sig-name descname"><span class="pre">pil2array</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">im</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">Image</span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">alpha</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">int</span></span><span class="w"> </span><span class="o"><span
                                        class="pre">=</span></span><span class="w"> </span><span
                                        class="default_value"><span class="pre">0</span></span></em><span
                                        class="sig-paren">)</span> <span class="sig-return"><span
                                        class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span
                                        class="pre">ndarray</span></span></span><a class="reference internal"
                                                                                   href="_modules/ajmc/ocr/pytorch/data_generation.html#pil2array"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_generation.pil2array"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Kraken linegen code.</p>
                                </dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_generation.textline_generator">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_generation.</span></span><span
                                        class="sig-name descname"><span
                                        class="pre">textline_generator</span></span><span class="sig-paren">(</span><em
                                        class="sig-param"><span class="n"><span class="pre">text</span></span><span
                                        class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                        class="n"><span class="pre">List</span><span class="p"><span
                                        class="pre">[</span></span><span class="pre">str</span><span class="p"><span
                                        class="pre">]</span></span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">offset</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">line_length_distribution</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span
                                        class="pre">int</span><span class="p"><span class="pre">,</span></span><span
                                        class="w"> </span><span class="pre">float</span><span class="p"><span
                                        class="pre">]</span></span></span></em><span class="sig-paren">)</span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/data_generation.html#textline_generator"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_generation.textline_generator"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Loops infinitely over a text to generate textlines from it.</p>
                                    <p>Args:
                                        text (List[str]): The text to generate textlines from, as a list of words</p>
                                </dd>
                            </dl>

                        </section>
                        <section id="module-ajmc.ocr.pytorch.data_processing">
                            <span id="ajmc-ocr-pytorch-data-processing-module"></span>
                            <h2>ajmc.ocr.pytorch.data_processing module<a class="headerlink"
                                                                          href="#module-ajmc.ocr.pytorch.data_processing"
                                                                          title="Link to this heading">#</a></h2>
                            <dl class="py class">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_processing.OcrBatch">
                                    <em class="property"><span class="pre">class</span><span
                                            class="w"> </span></em><span class="sig-prename descclassname"><span
                                        class="pre">ajmc.ocr.pytorch.data_processing.</span></span><span
                                        class="sig-name descname"><span class="pre">OcrBatch</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">ocr_lines</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">List</span><span class="p"><span class="pre">[</span></span><a
                                        class="reference internal" href="#ajmc.ocr.pytorch.data_processing.OcrLine"
                                        title="ajmc.ocr.pytorch.data_processing.OcrLine"><span
                                        class="pre">OcrLine</span></a><span class="p"><span class="pre">]</span></span></span></em><span
                                        class="sig-paren">)</span><a class="reference internal"
                                                                     href="_modules/ajmc/ocr/pytorch/data_processing.html#OcrBatch"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_processing.OcrBatch"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span
                                        class="pre">object</span></code></p>
                                    <dl class="py property">
                                        <dt class="sig sig-object py"
                                            id="ajmc.ocr.pytorch.data_processing.OcrBatch.chunks">
                                            <em class="property"><span class="pre">property</span><span
                                                    class="w"> </span></em><span class="sig-name descname"><span
                                                class="pre">chunks</span></span><em class="property"><span
                                                class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                                class="pre">torch.Tensor</span></em><a class="headerlink"
                                                                                       href="#ajmc.ocr.pytorch.data_processing.OcrBatch.chunks"
                                                                                       title="Link to this definition">#</a>
                                        </dt>
                                        <dd></dd>
                                    </dl>

                                    <dl class="py property">
                                        <dt class="sig sig-object py"
                                            id="ajmc.ocr.pytorch.data_processing.OcrBatch.chunks_to_img_mapping">
                                            <em class="property"><span class="pre">property</span><span
                                                    class="w"> </span></em><span class="sig-name descname"><span
                                                class="pre">chunks_to_img_mapping</span></span><em
                                                class="property"><span class="p"><span class="pre">:</span></span><span
                                                class="w"> </span><span class="pre">List</span><span class="p"><span
                                                class="pre">[</span></span><span class="pre">int</span><span
                                                class="p"><span class="pre">]</span></span></em><a class="headerlink"
                                                                                                   href="#ajmc.ocr.pytorch.data_processing.OcrBatch.chunks_to_img_mapping"
                                                                                                   title="Link to this definition">#</a>
                                        </dt>
                                        <dd></dd>
                                    </dl>

                                    <dl class="py property">
                                        <dt class="sig sig-object py"
                                            id="ajmc.ocr.pytorch.data_processing.OcrBatch.img_widths">
                                            <em class="property"><span class="pre">property</span><span
                                                    class="w"> </span></em><span class="sig-name descname"><span
                                                class="pre">img_widths</span></span><em class="property"><span
                                                class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                                class="pre">tuple</span></em><a class="headerlink"
                                                                                href="#ajmc.ocr.pytorch.data_processing.OcrBatch.img_widths"
                                                                                title="Link to this definition">#</a>
                                        </dt>
                                        <dd></dd>
                                    </dl>

                                    <dl class="py property">
                                        <dt class="sig sig-object py"
                                            id="ajmc.ocr.pytorch.data_processing.OcrBatch.text_lengths">
                                            <em class="property"><span class="pre">property</span><span
                                                    class="w"> </span></em><span class="sig-name descname"><span
                                                class="pre">text_lengths</span></span><em class="property"><span
                                                class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                                class="pre">tuple</span></em><a class="headerlink"
                                                                                href="#ajmc.ocr.pytorch.data_processing.OcrBatch.text_lengths"
                                                                                title="Link to this definition">#</a>
                                        </dt>
                                        <dd></dd>
                                    </dl>

                                    <dl class="py property">
                                        <dt class="sig sig-object py"
                                            id="ajmc.ocr.pytorch.data_processing.OcrBatch.texts">
                                            <em class="property"><span class="pre">property</span><span
                                                    class="w"> </span></em><span class="sig-name descname"><span
                                                class="pre">texts</span></span><em class="property"><span
                                                class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                                class="pre">List</span><span class="p"><span class="pre">[</span></span><span
                                                class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a
                                                class="headerlink"
                                                href="#ajmc.ocr.pytorch.data_processing.OcrBatch.texts"
                                                title="Link to this definition">#</a></dt>
                                        <dd></dd>
                                    </dl>

                                    <dl class="py property">
                                        <dt class="sig sig-object py"
                                            id="ajmc.ocr.pytorch.data_processing.OcrBatch.texts_tensor">
                                            <em class="property"><span class="pre">property</span><span
                                                    class="w"> </span></em><span class="sig-name descname"><span
                                                class="pre">texts_tensor</span></span><em class="property"><span
                                                class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                                class="pre">torch.Tensor</span></em><a class="headerlink"
                                                                                       href="#ajmc.ocr.pytorch.data_processing.OcrBatch.texts_tensor"
                                                                                       title="Link to this definition">#</a>
                                        </dt>
                                        <dd></dd>
                                    </dl>

                                </dd>
                            </dl>

                            <dl class="py class">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_processing.OcrIterDataset">
                                    <em class="property"><span class="pre">class</span><span
                                            class="w"> </span></em><span class="sig-prename descclassname"><span
                                        class="pre">ajmc.ocr.pytorch.data_processing.</span></span><span
                                        class="sig-name descname"><span class="pre">OcrIterDataset</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="o"><span
                                        class="pre">*</span></span><span class="n"><span
                                        class="pre">args</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span
                                        class="pre">**</span></span><span class="n"><span
                                        class="pre">kwargs</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">Any</span></span></em><span class="sig-paren">)</span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/data_processing.html#OcrIterDataset"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_processing.OcrIterDataset"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span
                                        class="pre">IterableDataset</span></code></p>
                                    <dl class="py method">
                                        <dt class="sig sig-object py"
                                            id="ajmc.ocr.pytorch.data_processing.OcrIterDataset.distribute">
                                            <span class="sig-name descname"><span
                                                    class="pre">distribute</span></span><span class="sig-paren">(</span><span
                                                class="sig-paren">)</span><a class="reference internal"
                                                                             href="_modules/ajmc/ocr/pytorch/data_processing.html#OcrIterDataset.distribute"><span
                                                class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                                class="headerlink"
                                                href="#ajmc.ocr.pytorch.data_processing.OcrIterDataset.distribute"
                                                title="Link to this definition">#</a></dt>
                                        <dd><p>Distributes the datasets accross workers, see <a
                                                class="reference external"
                                                href="https://pytorch.org/docs/stable/data.html#torch.utils.data.IterableDataset">https://pytorch.org/docs/stable/data.html#torch.utils.data.IterableDataset</a>
                                        </p>
                                        </dd>
                                    </dl>

                                </dd>
                            </dl>

                            <dl class="py class">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_processing.OcrLine">
                                    <em class="property"><span class="pre">class</span><span
                                            class="w"> </span></em><span class="sig-prename descclassname"><span
                                        class="pre">ajmc.ocr.pytorch.data_processing.</span></span><span
                                        class="sig-name descname"><span class="pre">OcrLine</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">img_path</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">img_height</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">chunk_width</span></span><span class="p"><span class="pre">:</span></span><span
                                        class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em
                                        class="sig-param"><span class="n"><span
                                        class="pre">chunk_overlap</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">classes_to_indices</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">dict</span></span></em><span class="sig-paren">)</span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/data_processing.html#OcrLine"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_processing.OcrLine"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span
                                        class="pre">object</span></code></p>
                                    <p>A custom class for OCR lines.</p>
                                    <div class="admonition note">
                                        <p class="admonition-title">Note</p>
                                        <ul class="simple">
                                            <li><p>A line corresponds both to a txt and an img if in train mode, only an
                                                image if not.</p></li>
                                            <li>
                                                <dl class="simple">
                                                    <dt>img<span class="classifier">the image of the line</span></dt>
                                                    <dd>
                                                        <ul>
                                                            <li><p>img_width: The width of the original image</p></li>
                                                            <li><p>img_height: The height of the original image</p></li>
                                                            <li><p>img_padding_length: The length of padding added for
                                                                batching in the decoder</p></li>
                                                        </ul>
                                                    </dd>
                                                </dl>
                                            </li>
                                            <li>
                                                <dl class="simple">
                                                    <dt>Chunks<span class="classifier">the chunks of the image of the line</span>
                                                    </dt>
                                                    <dd>
                                                        <ul>
                                                            <li><p>chunks_width: The widths of chunks</p></li>
                                                            <li><p>chunks_height = img height</p></li>
                                                            <li><p>chunks_count: The number of chunks</p></li>
                                                            <li><p>last_chunk_padding: The length of the padding added
                                                                to the last chunk.</p></li>
                                                        </ul>
                                                    </dd>
                                                </dl>
                                            </li>
                                            <li>
                                                <dl class="simple">
                                                    <dt>text<span class="classifier">the text corresponding to the image.</span>
                                                    </dt>
                                                    <dd>
                                                        <ul>
                                                            <li><p>text_length: The length of the text</p></li>
                                                        </ul>
                                                    </dd>
                                                </dl>
                                            </li>
                                        </ul>
                                    </div>
                                </dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_processing.chunk_img_tensor">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_processing.</span></span><span
                                        class="sig-name descname"><span class="pre">chunk_img_tensor</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">img_tensor</span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">chunk_width</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">chunk_overlap</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">int</span></span></em><span class="sig-paren">)</span> <span
                                        class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                        class="sig-return-typehint"><span
                                        class="pre">torch.Tensor</span></span></span><a class="reference internal"
                                                                                        href="_modules/ajmc/ocr/pytorch/data_processing.html#chunk_img_tensor"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_processing.chunk_img_tensor"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Chunks an image tensor of shape (1, height, width) into chunks of shape
                                    (N_chunks, height, chunk_width).</p>
                                    <dl class="field-list simple">
                                        <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                        <dd class="field-odd">
                                            <ul class="simple">
                                                <li><p><strong>img_tensor</strong> – The image tensor to chunk, of shape
                                                    (1, height, width).</p></li>
                                                <li><p><strong>chunk_width</strong> – The desired width of the chunks.
                                                </p></li>
                                                <li><p><strong>chunk_overlap</strong> – The desired overlap between the
                                                    chunks.</p></li>
                                            </ul>
                                        </dd>
                                        <dt class="field-even">Returns<span class="colon">:</span></dt>
                                        <dd class="field-even"><p>The image tensor chunked into chunks of shape
                                            (N_chunks, 1, height, chunk_width).</p>
                                        </dd>
                                    </dl>
                                </dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_processing.compute_n_chunks">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_processing.</span></span><span
                                        class="sig-name descname"><span class="pre">compute_n_chunks</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">img_tensor</span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">chunk_width</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">chunk_overlap</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">int</span></span></em><span class="sig-paren">)</span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/data_processing.html#compute_n_chunks"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_processing.compute_n_chunks"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Computes the number a chunks that can be extracted from an image tensor, given a
                                    chunk width and an overlap.</p>
                                    <div class="admonition note">
                                        <p class="admonition-title">Note</p>
                                        <p>We have <span class="math notranslate nohighlight">\(n * w - (n - 1) * o = W + padding\)</span>
                                            where <span class="math notranslate nohighlight">\(n\)</span> is the number
                                            of chunks, <span class="math notranslate nohighlight">\(w\)</span> is the
                                            chunk width, <span class="math notranslate nohighlight">\(o\)</span> is the
                                            overlap
                                            and <span class="math notranslate nohighlight">\(W\)</span> is the image
                                            width (without padding), which can be rewritten to : <span
                                                    class="math notranslate nohighlight">\(n (w - o) + o = W + padding\)</span>.
                                            Therefore,
                                            <span class="math notranslate nohighlight">\(n = (W+padding - o) / (w - o)\)</span>,
                                            and <span class="math notranslate nohighlight">\(n = (W+padding - o) // (w - o)\)</span>
                                            (<span class="math notranslate nohighlight">\(+ 1\)</span> if there is a
                                            remainder).</p>
                                    </div>
                                    <dl class="field-list simple">
                                        <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                        <dd class="field-odd">
                                            <ul class="simple">
                                                <li><p><strong>img_tensor</strong> – The image tensor from which to
                                                    extract the chunks.</p></li>
                                                <li><p><strong>chunk_width</strong> – The width of the chunks.</p></li>
                                                <li><p><strong>chunk_overlap</strong> – The overlap between the chunks.
                                                </p></li>
                                            </ul>
                                        </dd>
                                        <dt class="field-even">Returns<span class="colon">:</span></dt>
                                        <dd class="field-even"><p>The number of chunks that can be extracted from the
                                            image tensor.</p>
                                        </dd>
                                    </dl>
                                </dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_processing.compute_padding">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_processing.</span></span><span
                                        class="sig-name descname"><span class="pre">compute_padding</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">img_tensor</span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">n_chunks</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">chunk_width</span></span><span class="p"><span class="pre">:</span></span><span
                                        class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em
                                        class="sig-param"><span class="n"><span
                                        class="pre">chunk_overlap</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">int</span></span></em><span class="sig-paren">)</span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/data_processing.html#compute_padding"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_processing.compute_padding"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Computes the padding to apply to an image tensor to extract chunks of a given
                                    width with a given overlap.</p>
                                    <dl class="field-list simple">
                                        <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                        <dd class="field-odd">
                                            <ul class="simple">
                                                <li><p><strong>img_tensor</strong> – The image tensor from which to
                                                    extract the chunks.</p></li>
                                                <li><p><strong>n_chunks</strong> – The number of chunks to extract.</p>
                                                </li>
                                                <li><p><strong>chunk_width</strong> – The width of the chunks.</p></li>
                                                <li><p><strong>chunk_overlap</strong> – The overlap between the chunks.
                                                </p></li>
                                            </ul>
                                        </dd>
                                        <dt class="field-even">Returns<span class="colon">:</span></dt>
                                        <dd class="field-even"><p>The padding to apply to the image tensor.</p>
                                        </dd>
                                    </dl>
                                </dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py"
                                    id="ajmc.ocr.pytorch.data_processing.crop_image_tensor_to_nonzero">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_processing.</span></span><span
                                        class="sig-name descname"><span class="pre">crop_image_tensor_to_nonzero</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">image_tensor</span></span><span class="p"><span class="pre">:</span></span><span
                                        class="w"> </span><span class="n"><span
                                        class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span>
                                    <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                            class="sig-return-typehint"><span
                                            class="pre">torch.Tensor</span></span></span><a class="reference internal"
                                                                                            href="_modules/ajmc/ocr/pytorch/data_processing.html#crop_image_tensor_to_nonzero"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink"
                                        href="#ajmc.ocr.pytorch.data_processing.crop_image_tensor_to_nonzero"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Crops an image tensor of shape (1, height, width) to the smallest bounding box
                                    containing all non-zero pixels.</p>
                                </dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py"
                                    id="ajmc.ocr.pytorch.data_processing.get_custom_dataloader">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_processing.</span></span><span
                                        class="sig-name descname"><span
                                        class="pre">get_custom_dataloader</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">train_dataset</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">torch.utils.data.Dataset</span></span></em>, <em
                                        class="sig-param"><span class="n"><span
                                        class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span
                                        class="w"> </span><span class="n"><span class="pre">int</span></span></em><span
                                        class="sig-paren">)</span> <span class="sig-return"><span
                                        class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span
                                        class="pre">torch.utils.data.DataLoader</span></span></span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/data_processing.html#get_custom_dataloader"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink"
                                        href="#ajmc.ocr.pytorch.data_processing.get_custom_dataloader"
                                        title="Link to this definition">#</a></dt>
                                <dd></dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_processing.invert_image_tensor">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_processing.</span></span><span
                                        class="sig-name descname"><span
                                        class="pre">invert_image_tensor</span></span><span class="sig-paren">(</span><em
                                        class="sig-param"><span class="n"><span
                                        class="pre">image_tensor</span></span></em><span class="sig-paren">)</span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/data_processing.html#invert_image_tensor"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_processing.invert_image_tensor"
                                        title="Link to this definition">#</a></dt>
                                <dd></dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py"
                                    id="ajmc.ocr.pytorch.data_processing.normalize_image_tensor">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_processing.</span></span><span
                                        class="sig-name descname"><span class="pre">normalize_image_tensor</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">image_tensor</span></span></em><span class="sig-paren">)</span>
                                    <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                            class="sig-return-typehint"><span
                                            class="pre">torch.Tensor</span></span></span><a class="reference internal"
                                                                                            href="_modules/ajmc/ocr/pytorch/data_processing.html#normalize_image_tensor"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink"
                                        href="#ajmc.ocr.pytorch.data_processing.normalize_image_tensor"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Prepares an image tensor for training.</p>
                                </dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_processing.prepare_img">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_processing.</span></span><span
                                        class="sig-name descname"><span class="pre">prepare_img</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">img_path</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">img_height</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">int</span></span></em><span class="sig-paren">)</span> <span
                                        class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                        class="sig-return-typehint"><span
                                        class="pre">torch.Tensor</span></span></span><a class="reference internal"
                                                                                        href="_modules/ajmc/ocr/pytorch/data_processing.html#prepare_img"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_processing.prepare_img"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Prepares an image tensor for training.</p>
                                    <dl class="field-list simple">
                                        <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                        <dd class="field-odd">
                                            <ul class="simple">
                                                <li><p><strong>img_path</strong> – The path to a grayscale image of
                                                    shape (1, initial_height, initial_width).</p></li>
                                                <li><p><strong>img_height</strong> – The height to which to resize the
                                                    image.</p></li>
                                            </ul>
                                        </dd>
                                        <dt class="field-even">Returns<span class="colon">:</span></dt>
                                        <dd class="field-even"><p>The prepared image tensor, in shape (1, img_height,
                                            resized_width).</p>
                                        </dd>
                                    </dl>
                                </dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py"
                                    id="ajmc.ocr.pytorch.data_processing.recompose_batched_chunks">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_processing.</span></span><span
                                        class="sig-name descname"><span
                                        class="pre">recompose_batched_chunks</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">batched_chunks</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">mapping</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">List</span><span class="p"><span class="pre">[</span></span><span
                                        class="pre">int</span><span class="p"><span
                                        class="pre">]</span></span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">chunk_overlap</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">int</span></span></em><span class="sig-paren">)</span> <span
                                        class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                        class="sig-return-typehint"><span
                                        class="pre">torch.Tensor</span></span></span><a class="reference internal"
                                                                                        href="_modules/ajmc/ocr/pytorch/data_processing.html#recompose_batched_chunks"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink"
                                        href="#ajmc.ocr.pytorch.data_processing.recompose_batched_chunks"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Apply <code class="docutils literal notranslate"><span class="pre">recompose_chunks</span></code>
                                    to a batch of chunks.</p>
                                    <div class="admonition warning">
                                        <p class="admonition-title">Warning</p>
                                        <p>This function is to be applied on a processed batch of chunks, with the shape
                                            (n_chunks, chunk_width, chunk_height [or num_classes if performed after
                                            decoder).</p>
                                    </div>
                                    <dl class="field-list simple">
                                        <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                        <dd class="field-odd">
                                            <ul class="simple">
                                                <li><p><strong>batched_chunks</strong> – The batch of chunks, in shape
                                                    (n_chunks, chunk_width, chunk_height [or num_classes if performed
                                                    after decoder).</p></li>
                                                <li><p><strong>mapping</strong> – The mapping from the batch to the
                                                    original image tensor, in shape (1). The mapping is a tensor of
                                                    integers, where each integer represents the number of chunks that
                                                    were extracted from the original image
                                                    tensor. Eg : [3, 2] means that the first image tensor was chunked
                                                    into 3 chunks, the second into 2 chunks.</p></li>
                                                <li><p><strong>chunk_overlap</strong> – The overlap between the chunks.
                                                </p></li>
                                            </ul>
                                        </dd>
                                        <dt class="field-even">Returns<span class="colon">:</span></dt>
                                        <dd class="field-even"><p>The reassembled image tensor, in shape (n_images, 1,
                                            img_height, img_width+eventual padding).</p>
                                        </dd>
                                    </dl>
                                </dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.data_processing.recompose_chunks">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.data_processing.</span></span><span
                                        class="sig-name descname"><span class="pre">recompose_chunks</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">chunks</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">chunk_overlap</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">int</span></span></em><span class="sig-paren">)</span> <span
                                        class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                        class="sig-return-typehint"><span
                                        class="pre">torch.Tensor</span></span></span><a class="reference internal"
                                                                                        href="_modules/ajmc/ocr/pytorch/data_processing.html#recompose_chunks"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.data_processing.recompose_chunks"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Reassembles chunks of an image tensor into a single image tensor.</p>
                                    <dl class="field-list simple">
                                        <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                        <dd class="field-odd">
                                            <ul class="simple">
                                                <li><p><strong>chunks</strong> – The chunks to reassemble, in shape
                                                    (n_chunks, width, height). Note that the channels dimension is not
                                                    present, as the chunks are grayscale images. processed by the
                                                    encoder.</p></li>
                                                <li><p><strong>chunk_overlap</strong> – The overlap between the chunks.
                                                </p></li>
                                            </ul>
                                        </dd>
                                        <dt class="field-even">Returns<span class="colon">:</span></dt>
                                        <dd class="field-even"><p>The reassembled image tensor, in shape (width,
                                            height).</p>
                                        </dd>
                                    </dl>
                                </dd>
                            </dl>

                        </section>
                        <section id="module-ajmc.ocr.pytorch.datasets">
                            <span id="ajmc-ocr-pytorch-datasets-module"></span>
                            <h2>ajmc.ocr.pytorch.datasets module<a class="headerlink"
                                                                   href="#module-ajmc.ocr.pytorch.datasets"
                                                                   title="Link to this heading">#</a></h2>
                            <dl class="simple">
                                <dt>Files :</dt>
                                <dd>
                                    <ul class="simple">
                                        <li><p>1 img : .pt resized, inverted, normalized, chunked, numbered,
                                            overlapping</p></li>
                                        <li><p>1 txt : utf-8, NFD</p></li>
                                    </ul>
                                </dd>
                                <dt>Dataset :</dt>
                                <dd>
                                    <ul class="simple">
                                        <li><p>takes the</p></li>
                                    </ul>
                                </dd>
                                <dt>Dataloader / sampler :</dt>
                                <dd>
                                    <ul class="simple">
                                        <li><p>Receives chunks, fills batch until full, returns it.</p></li>
                                    </ul>
                                </dd>
                            </dl>
                            <dl class="py class">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.datasets.OcrEvalDataset">
                                    <em class="property"><span class="pre">class</span><span
                                            class="w"> </span></em><span class="sig-prename descclassname"><span
                                        class="pre">ajmc.ocr.pytorch.datasets.</span></span><span
                                        class="sig-name descname"><span class="pre">OcrEvalDataset</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">data_dir</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">classes</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">List</span><span class="p"><span class="pre">[</span></span><span
                                        class="pre">str</span><span class="p"><span
                                        class="pre">]</span></span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">blank</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">str</span></span><span class="w"> </span><span class="o"><span
                                        class="pre">=</span></span><span class="w"> </span><span
                                        class="default_value"><span class="pre">'&#64;'</span></span></em><span
                                        class="sig-paren">)</span><a class="reference internal"
                                                                     href="_modules/ajmc/ocr/pytorch/datasets.html#OcrEvalDataset"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.datasets.OcrEvalDataset"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Bases: <a class="reference internal"
                                                 href="#ajmc.ocr.pytorch.datasets.OcrTorchDataset"
                                                 title="ajmc.ocr.pytorch.datasets.OcrTorchDataset"><code
                                        class="xref py py-class docutils literal notranslate"><span class="pre">OcrTorchDataset</span></code></a>
                                </p>
                                </dd>
                            </dl>

                            <dl class="py class">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.datasets.OcrTorchDataset">
                                    <em class="property"><span class="pre">class</span><span
                                            class="w"> </span></em><span class="sig-prename descclassname"><span
                                        class="pre">ajmc.ocr.pytorch.datasets.</span></span><span
                                        class="sig-name descname"><span class="pre">OcrTorchDataset</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">data_dir</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">classes</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">List</span><span class="p"><span class="pre">[</span></span><span
                                        class="pre">str</span><span class="p"><span
                                        class="pre">]</span></span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">blank</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">str</span></span><span class="w"> </span><span class="o"><span
                                        class="pre">=</span></span><span class="w"> </span><span
                                        class="default_value"><span class="pre">'&#64;'</span></span></em><span
                                        class="sig-paren">)</span><a class="reference internal"
                                                                     href="_modules/ajmc/ocr/pytorch/datasets.html#OcrTorchDataset"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.datasets.OcrTorchDataset"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span
                                        class="pre">Dataset</span></code></p>
                                    <dl class="py property">
                                        <dt class="sig sig-object py"
                                            id="ajmc.ocr.pytorch.datasets.OcrTorchDataset.classes_to_indices">
                                            <em class="property"><span class="pre">property</span><span
                                                    class="w"> </span></em><span class="sig-name descname"><span
                                                class="pre">classes_to_indices</span></span><a class="headerlink"
                                                                                               href="#ajmc.ocr.pytorch.datasets.OcrTorchDataset.classes_to_indices"
                                                                                               title="Link to this definition">#</a>
                                        </dt>
                                        <dd></dd>
                                    </dl>

                                    <dl class="py property">
                                        <dt class="sig sig-object py"
                                            id="ajmc.ocr.pytorch.datasets.OcrTorchDataset.indices_to_classes">
                                            <em class="property"><span class="pre">property</span><span
                                                    class="w"> </span></em><span class="sig-name descname"><span
                                                class="pre">indices_to_classes</span></span><a class="headerlink"
                                                                                               href="#ajmc.ocr.pytorch.datasets.OcrTorchDataset.indices_to_classes"
                                                                                               title="Link to this definition">#</a>
                                        </dt>
                                        <dd></dd>
                                    </dl>

                                </dd>
                            </dl>

                            <dl class="py class">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.datasets.OcrTrainingDataset">
                                    <em class="property"><span class="pre">class</span><span
                                            class="w"> </span></em><span class="sig-prename descclassname"><span
                                        class="pre">ajmc.ocr.pytorch.datasets.</span></span><span
                                        class="sig-name descname"><span
                                        class="pre">OcrTrainingDataset</span></span><span class="sig-paren">(</span><em
                                        class="sig-param"><span class="n"><span class="pre">data_dir</span></span><span
                                        class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                        class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">classes</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">List</span><span class="p"><span class="pre">[</span></span><span
                                        class="pre">str</span><span class="p"><span
                                        class="pre">]</span></span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">blank</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">str</span></span><span class="w"> </span><span class="o"><span
                                        class="pre">=</span></span><span class="w"> </span><span
                                        class="default_value"><span class="pre">'&#64;'</span></span></em><span
                                        class="sig-paren">)</span><a class="reference internal"
                                                                     href="_modules/ajmc/ocr/pytorch/datasets.html#OcrTrainingDataset"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.datasets.OcrTrainingDataset"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Bases: <a class="reference internal"
                                                 href="#ajmc.ocr.pytorch.datasets.OcrTorchDataset"
                                                 title="ajmc.ocr.pytorch.datasets.OcrTorchDataset"><code
                                        class="xref py py-class docutils literal notranslate"><span class="pre">OcrTorchDataset</span></code></a>
                                </p>
                                </dd>
                            </dl>

                        </section>
                        <section id="module-ajmc.ocr.pytorch.model">
                            <span id="ajmc-ocr-pytorch-model-module"></span>
                            <h2>ajmc.ocr.pytorch.model module<a class="headerlink" href="#module-ajmc.ocr.pytorch.model"
                                                                title="Link to this heading">#</a></h2>
                            <p>Model classes for torch based ocr models.</p>
                            <dl class="py class">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.model.DenseNetBackbone">
                                    <em class="property"><span class="pre">class</span><span
                                            class="w"> </span></em><span class="sig-prename descclassname"><span
                                        class="pre">ajmc.ocr.pytorch.model.</span></span><span
                                        class="sig-name descname"><span class="pre">DenseNetBackbone</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">growth_rate</span></span><span class="p"><span class="pre">:</span></span><span
                                        class="w"> </span><span class="n"><span class="pre">int</span></span><span
                                        class="w"> </span><span class="o"><span class="pre">=</span></span><span
                                        class="w"> </span><span class="default_value"><span class="pre">32</span></span></em>,
                                    <em class="sig-param"><span class="n"><span
                                            class="pre">block_config</span></span><span class="p"><span
                                            class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                            class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span
                                            class="pre">int</span><span class="p"><span
                                            class="pre">]</span></span></span><span class="w"> </span><span
                                            class="o"><span class="pre">=</span></span><span class="w"> </span><span
                                            class="default_value"><span class="pre">(6,</span> <span
                                            class="pre">12,</span> <span class="pre">24,</span> <span
                                            class="pre">16)</span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">num_init_features</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">int</span></span><span class="w"> </span><span class="o"><span
                                        class="pre">=</span></span><span class="w"> </span><span
                                        class="default_value"><span class="pre">32</span></span></em>, <em
                                        class="sig-param"><span class="n"><span class="pre">bn_size</span></span><span
                                        class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                        class="n"><span class="pre">int</span></span><span class="w"> </span><span
                                        class="o"><span class="pre">=</span></span><span class="w"> </span><span
                                        class="default_value"><span class="pre">4</span></span></em>, <em
                                        class="sig-param"><span class="n"><span class="pre">drop_rate</span></span><span
                                        class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                        class="n"><span class="pre">float</span></span><span class="w"> </span><span
                                        class="o"><span class="pre">=</span></span><span class="w"> </span><span
                                        class="default_value"><span class="pre">0</span></span></em>, <em
                                        class="sig-param"><span class="n"><span
                                        class="pre">memory_efficient</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">bool</span></span><span class="w"> </span><span class="o"><span
                                        class="pre">=</span></span><span class="w"> </span><span
                                        class="default_value"><span class="pre">False</span></span></em><span
                                        class="sig-paren">)</span><a class="reference internal"
                                                                     href="_modules/ajmc/ocr/pytorch/model.html#DenseNetBackbone"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.model.DenseNetBackbone"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span
                                        class="pre">Module</span></code></p>
                                    <p>A customised DenseNet backbone.</p>
                                    <p>Customisation notably including single channel inputs, pooling and squeezing the
                                        outputs, as
                                        well as adapting accepted block configurations.</p>
                                    <dl class="py method">
                                        <dt class="sig sig-object py"
                                            id="ajmc.ocr.pytorch.model.DenseNetBackbone.forward">
                                            <span class="sig-name descname"><span class="pre">forward</span></span><span
                                                class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                                class="pre">x</span></span><span class="p"><span
                                                class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                                class="pre">Tensor</span></span></em><span class="sig-paren">)</span>
                                            <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                                    class="sig-return-typehint"><span
                                                    class="pre">Tensor</span></span></span><a class="reference internal"
                                                                                              href="_modules/ajmc/ocr/pytorch/model.html#DenseNetBackbone.forward"><span
                                                class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                                class="headerlink"
                                                href="#ajmc.ocr.pytorch.model.DenseNetBackbone.forward"
                                                title="Link to this definition">#</a></dt>
                                        <dd><p>Defines the computation performed at every call.</p>
                                            <p>Should be overridden by all subclasses.</p>
                                            <div class="admonition note">
                                                <p class="admonition-title">Note</p>
                                                <p>Although the recipe for forward pass needs to be defined within
                                                    this function, one should call the <code
                                                            class="xref py py-class docutils literal notranslate"><span
                                                            class="pre">Module</span></code> instance afterwards
                                                    instead of this since the former takes care of running the
                                                    registered hooks while the latter silently ignores them.</p>
                                            </div>
                                        </dd>
                                    </dl>

                                    <dl class="py method">
                                        <dt class="sig sig-object py"
                                            id="ajmc.ocr.pytorch.model.DenseNetBackbone.from_config">
                                            <em class="property"><span class="pre">classmethod</span><span
                                                    class="w"> </span></em><span class="sig-name descname"><span
                                                class="pre">from_config</span></span><span class="sig-paren">(</span><em
                                                class="sig-param"><span class="n"><span class="pre">config</span></span><span
                                                class="p"><span class="pre">:</span></span><span class="w"> </span><span
                                                class="n"><span class="pre">dict</span></span></em><span
                                                class="sig-paren">)</span><a class="reference internal"
                                                                             href="_modules/ajmc/ocr/pytorch/model.html#DenseNetBackbone.from_config"><span
                                                class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                                class="headerlink"
                                                href="#ajmc.ocr.pytorch.model.DenseNetBackbone.from_config"
                                                title="Link to this definition">#</a></dt>
                                        <dd></dd>
                                    </dl>

                                </dd>
                            </dl>

                            <dl class="py class">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.model.OcrTorchModel">
                                    <em class="property"><span class="pre">class</span><span
                                            class="w"> </span></em><span class="sig-prename descclassname"><span
                                        class="pre">ajmc.ocr.pytorch.model.</span></span><span
                                        class="sig-name descname"><span class="pre">OcrTorchModel</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">config</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">dict</span></span></em><span class="sig-paren">)</span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/model.html#OcrTorchModel"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.model.OcrTorchModel"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span
                                        class="pre">Module</span></code></p>
                                    <dl class="py method">
                                        <dt class="sig sig-object py" id="ajmc.ocr.pytorch.model.OcrTorchModel.forward">
                                            <span class="sig-name descname"><span class="pre">forward</span></span><span
                                                class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                                class="pre">x</span></span><span class="p"><span
                                                class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                                class="pre">Tensor</span></span></em><span class="sig-paren">)</span>
                                            <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span
                                                    class="sig-return-typehint"><span
                                                    class="pre">Tensor</span></span></span><a class="reference internal"
                                                                                              href="_modules/ajmc/ocr/pytorch/model.html#OcrTorchModel.forward"><span
                                                class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                                class="headerlink" href="#ajmc.ocr.pytorch.model.OcrTorchModel.forward"
                                                title="Link to this definition">#</a></dt>
                                        <dd>
                                            <dl class="field-list simple">
                                                <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                                <dd class="field-odd">
                                                    <ul class="simple">
                                                        <li><p><strong>x</strong> – A torch tensor of shape (batch_size,
                                                            1, height, width) representing a grayscale image chunks,
                                                            normalized to [0, 1] and white on black.</p></li>
                                                        <li><p><strong>mapping</strong> – A torch tensor of shape (1)
                                                            representing the mapping from the image chunks to the
                                                            original image.</p></li>
                                                    </ul>
                                                </dd>
                                            </dl>
                                        </dd>
                                    </dl>

                                    <dl class="py method">
                                        <dt class="sig sig-object py" id="ajmc.ocr.pytorch.model.OcrTorchModel.predict">
                                            <span class="sig-name descname"><span class="pre">predict</span></span><span
                                                class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                                class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span
                                                class="pre">chunks_to_img_mapping</span></span></em><span
                                                class="sig-paren">)</span> <span class="sig-return"><span
                                                class="sig-return-icon">&#x2192;</span> <span
                                                class="sig-return-typehint"><span class="pre">List</span><span
                                                class="p"><span class="pre">[</span></span><span
                                                class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a
                                                class="reference internal"
                                                href="_modules/ajmc/ocr/pytorch/model.html#OcrTorchModel.predict"><span
                                                class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                                class="headerlink" href="#ajmc.ocr.pytorch.model.OcrTorchModel.predict"
                                                title="Link to this definition">#</a></dt>
                                        <dd><p>Predicts the text in a batch of image tensors.</p>
                                            <dl class="field-list simple">
                                                <dt class="field-odd">Parameters<span class="colon">:</span></dt>
                                                <dd class="field-odd"><p><strong>x</strong> – A torch tensor of shape
                                                    (batch_size, width, height).</p>
                                                </dd>
                                                <dt class="field-even">Returns<span class="colon">:</span></dt>
                                                <dd class="field-even"><p>A list of strings representing the predicted
                                                    text.</p>
                                                </dd>
                                            </dl>
                                        </dd>
                                    </dl>

                                </dd>
                            </dl>

                        </section>
                        <section id="module-ajmc.ocr.pytorch.train_parallel">
                            <span id="ajmc-ocr-pytorch-train-parallel-module"></span>
                            <h2>ajmc.ocr.pytorch.train_parallel module<a class="headerlink"
                                                                         href="#module-ajmc.ocr.pytorch.train_parallel"
                                                                         title="Link to this heading">#</a></h2>
                            <dl class="py class">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.train_parallel.OcrModelTrainer">
                                    <em class="property"><span class="pre">class</span><span
                                            class="w"> </span></em><span class="sig-prename descclassname"><span
                                        class="pre">ajmc.ocr.pytorch.train_parallel.</span></span><span
                                        class="sig-name descname"><span class="pre">OcrModelTrainer</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">model:</span> <span class="pre">~ajmc.ocr.pytorch.model.OcrTorchModel</span></span></em>,
                                    <em class="sig-param"><span class="n"><span class="pre">train_dataset:</span> <span
                                            class="pre">~ajmc.ocr.pytorch.data_processing.OcrIterDataset</span></span></em>,
                                    <em class="sig-param"><span class="n"><span class="pre">eval_dataset:</span> <span
                                            class="pre">~ajmc.ocr.pytorch.data_processing.OcrIterDataset</span></span></em>,
                                    <em class="sig-param"><span class="n"><span class="pre">optimizer:</span> <span
                                            class="pre">~torch.optim.optimizer.Optimizer</span></span></em>, <em
                                        class="sig-param"><span class="n"><span class="pre">scheduler:</span> <span
                                        class="pre">&lt;module</span> <span
                                        class="pre">'torch.optim.lr_scheduler'</span> <span
                                        class="pre">from</span> <span class="pre">'/Users/sven/opt/anaconda3/envs/ajmc/lib/python3.11/site-packages/torch/optim/lr_scheduler.py'&gt;</span></span></em>,
                                    <em class="sig-param"><span class="n"><span class="pre">scheduler_step_rate:</span> <span
                                            class="pre">int</span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">snapshot_rate:</span> <span
                                        class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">snapshot_path:</span> <span class="pre">~pathlib.Path</span></span></em>,
                                    <em class="sig-param"><span class="n"><span
                                            class="pre">evaluation_rate:</span> <span class="pre">int</span></span></em>,
                                    <em class="sig-param"><span class="n"><span
                                            class="pre">evaluation_output_dir:</span> <span
                                            class="pre">~pathlib.Path</span></span></em>, <em class="sig-param"><span
                                        class="n"><span class="pre">chunk_overlap:</span> <span
                                        class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span
                                        class="pre">num_workers:</span> <span class="pre">int</span></span></em>, <em
                                        class="sig-param"><span class="n"><span class="pre">device:</span> <span
                                        class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span
                                        class="pre">=</span> <span class="pre">None</span></span></em><span
                                        class="sig-paren">)</span><a class="reference internal"
                                                                     href="_modules/ajmc/ocr/pytorch/train_parallel.html#OcrModelTrainer"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.train_parallel.OcrModelTrainer"
                                        title="Link to this definition">#</a></dt>
                                <dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span
                                        class="pre">object</span></code></p>
                                    <dl class="py method">
                                        <dt class="sig sig-object py"
                                            id="ajmc.ocr.pytorch.train_parallel.OcrModelTrainer.train">
                                            <span class="sig-name descname"><span class="pre">train</span></span><span
                                                class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                                class="pre">total_steps</span></span><span class="p"><span
                                                class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                                class="pre">int</span></span></em><span class="sig-paren">)</span><a
                                                class="reference internal"
                                                href="_modules/ajmc/ocr/pytorch/train_parallel.html#OcrModelTrainer.train"><span
                                                class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                                class="headerlink"
                                                href="#ajmc.ocr.pytorch.train_parallel.OcrModelTrainer.train"
                                                title="Link to this definition">#</a></dt>
                                        <dd></dd>
                                    </dl>

                                </dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.train_parallel.ddp_setup">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.train_parallel.</span></span><span
                                        class="sig-name descname"><span class="pre">ddp_setup</span></span><span
                                        class="sig-paren">(</span><span class="sig-paren">)</span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/train_parallel.html#ddp_setup"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.train_parallel.ddp_setup"
                                        title="Link to this definition">#</a></dt>
                                <dd></dd>
                            </dl>

                            <dl class="py function">
                                <dt class="sig sig-object py" id="ajmc.ocr.pytorch.train_parallel.main">
                                    <span class="sig-prename descclassname"><span class="pre">ajmc.ocr.pytorch.train_parallel.</span></span><span
                                        class="sig-name descname"><span class="pre">main</span></span><span
                                        class="sig-paren">(</span><em class="sig-param"><span class="n"><span
                                        class="pre">config</span></span><span class="p"><span
                                        class="pre">:</span></span><span class="w"> </span><span class="n"><span
                                        class="pre">dict</span></span></em><span class="sig-paren">)</span><a
                                        class="reference internal"
                                        href="_modules/ajmc/ocr/pytorch/train_parallel.html#main"><span
                                        class="viewcode-link"><span class="pre">[source]</span></span></a><a
                                        class="headerlink" href="#ajmc.ocr.pytorch.train_parallel.main"
                                        title="Link to this definition">#</a></dt>
                                <dd></dd>
                            </dl>

                        </section>
                    </section>

                </article>
            </div>
            <footer>

                <div class="related-pages">
                    <a class="next-page" href="ajmc.ocr.tesseract.html">
                        <div class="page-info">
                            <div class="context">
                                <span>Next</span>
                            </div>
                            <div class="title">ajmc.ocr.tesseract package</div>
                        </div>
                        <svg class="furo-related-icon">
                            <use href="#svg-arrow-right"></use>
                        </svg>
                    </a>
                    <a class="prev-page" href="ajmc.ocr.preprocessing.html">
                        <svg class="furo-related-icon">
                            <use href="#svg-arrow-right"></use>
                        </svg>
                        <div class="page-info">
                            <div class="context">
                                <span>Previous</span>
                            </div>

                            <div class="title">ajmc.ocr.preprocessing package</div>

                        </div>
                    </a>
                </div>
                <div class="bottom-of-page">
                    <div class="left-details">
                        <div class="copyright">
                            Copyright &#169; 2023, Sven Najem-Meyer
                        </div>
                        Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link"
                                                                                          href="https://pradyunsg.me">@pradyunsg</a>'s

                        <a href="https://github.com/pradyunsg/furo">Furo</a>

                    </div>
                    <div class="right-details">

                    </div>
                </div>

            </footer>
        </div>
        <aside class="toc-drawer">


            <div class="toc-sticky toc-scroll">
                <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
                </div>
                <div class="toc-tree-container">
                    <div class="toc-tree">
                        <ul>
                            <li><a class="reference internal" href="#">ajmc.ocr.pytorch package</a>
                                <ul>
                                    <li><a class="reference internal" href="#submodules">Submodules</a></li>
                                    <li><a class="reference internal" href="#module-ajmc.ocr.pytorch.config">ajmc.ocr.pytorch.config
                                        module</a>
                                        <ul>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.config.get_config"><code
                                                    class="docutils literal notranslate"><span
                                                    class="pre">get_config()</span></code></a></li>
                                        </ul>
                                    </li>
                                    <li><a class="reference internal" href="#module-ajmc.ocr.pytorch.ctc_decoder_torch">ajmc.ocr.pytorch.ctc_decoder_torch
                                        module</a>
                                        <ul>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.ctc_decoder_torch.BeamCTCDecoder"><code
                                                    class="docutils literal notranslate"><span class="pre">BeamCTCDecoder</span></code></a>
                                                <ul>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.ctc_decoder_torch.BeamCTCDecoder.convert_tensor"><code
                                                            class="docutils literal notranslate"><span class="pre">BeamCTCDecoder.convert_tensor()</span></code></a>
                                                    </li>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.ctc_decoder_torch.BeamCTCDecoder.convert_to_strings"><code
                                                            class="docutils literal notranslate"><span class="pre">BeamCTCDecoder.convert_to_strings()</span></code></a>
                                                    </li>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.ctc_decoder_torch.BeamCTCDecoder.decode"><code
                                                            class="docutils literal notranslate"><span class="pre">BeamCTCDecoder.decode()</span></code></a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.ctc_decoder_torch.Decoder"><code
                                                    class="docutils literal notranslate"><span
                                                    class="pre">Decoder</span></code></a>
                                                <ul>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.ctc_decoder_torch.Decoder.decode"><code
                                                            class="docutils literal notranslate"><span class="pre">Decoder.decode()</span></code></a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.ctc_decoder_torch.GreedyDecoder"><code
                                                    class="docutils literal notranslate"><span
                                                    class="pre">GreedyDecoder</span></code></a>
                                                <ul>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.ctc_decoder_torch.GreedyDecoder.convert_to_strings"><code
                                                            class="docutils literal notranslate"><span class="pre">GreedyDecoder.convert_to_strings()</span></code></a>
                                                    </li>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.ctc_decoder_torch.GreedyDecoder.decode"><code
                                                            class="docutils literal notranslate"><span class="pre">GreedyDecoder.decode()</span></code></a>
                                                    </li>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.ctc_decoder_torch.GreedyDecoder.process_string"><code
                                                            class="docutils literal notranslate"><span class="pre">GreedyDecoder.process_string()</span></code></a>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a class="reference internal" href="#module-ajmc.ocr.pytorch.data_generation">ajmc.ocr.pytorch.data_generation
                                        module</a>
                                        <ul>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_generation.array2pil"><code
                                                    class="docutils literal notranslate"><span
                                                    class="pre">array2pil()</span></code></a></li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_generation.check_file_count"><code
                                                    class="docutils literal notranslate"><span class="pre">check_file_count()</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_generation.create_sample_dir"><code
                                                    class="docutils literal notranslate"><span class="pre">create_sample_dir()</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_generation.degrade_line"><code
                                                    class="docutils literal notranslate"><span class="pre">degrade_line()</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_generation.distort_line"><code
                                                    class="docutils literal notranslate"><span class="pre">distort_line()</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_generation.do_all_purpose_fonts"><code
                                                    class="docutils literal notranslate"><span class="pre">do_all_purpose_fonts()</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_generation.do_capitals"><code
                                                    class="docutils literal notranslate"><span
                                                    class="pre">do_capitals()</span></code></a></li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_generation.do_gibberish"><code
                                                    class="docutils literal notranslate"><span class="pre">do_gibberish()</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_generation.do_greek_fonts"><code
                                                    class="docutils literal notranslate"><span class="pre">do_greek_fonts()</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_generation.do_latin_fonts"><code
                                                    class="docutils literal notranslate"><span class="pre">do_latin_fonts()</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_generation.do_mixed_fonts"><code
                                                    class="docutils literal notranslate"><span class="pre">do_mixed_fonts()</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_generation.draw_textline"><code
                                                    class="docutils literal notranslate"><span class="pre">draw_textline()</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_generation.get_textline_font_variants"><code
                                                    class="docutils literal notranslate"><span class="pre">get_textline_font_variants()</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_generation.get_textline_generators"><code
                                                    class="docutils literal notranslate"><span class="pre">get_textline_generators()</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_generation.inner_loop"><code
                                                    class="docutils literal notranslate"><span
                                                    class="pre">inner_loop()</span></code></a></li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_generation.pad_image"><code
                                                    class="docutils literal notranslate"><span
                                                    class="pre">pad_image()</span></code></a></li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_generation.pil2array"><code
                                                    class="docutils literal notranslate"><span
                                                    class="pre">pil2array()</span></code></a></li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_generation.textline_generator"><code
                                                    class="docutils literal notranslate"><span class="pre">textline_generator()</span></code></a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a class="reference internal" href="#module-ajmc.ocr.pytorch.data_processing">ajmc.ocr.pytorch.data_processing
                                        module</a>
                                        <ul>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_processing.OcrBatch"><code
                                                    class="docutils literal notranslate"><span
                                                    class="pre">OcrBatch</span></code></a>
                                                <ul>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.data_processing.OcrBatch.chunks"><code
                                                            class="docutils literal notranslate"><span class="pre">OcrBatch.chunks</span></code></a>
                                                    </li>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.data_processing.OcrBatch.chunks_to_img_mapping"><code
                                                            class="docutils literal notranslate"><span class="pre">OcrBatch.chunks_to_img_mapping</span></code></a>
                                                    </li>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.data_processing.OcrBatch.img_widths"><code
                                                            class="docutils literal notranslate"><span class="pre">OcrBatch.img_widths</span></code></a>
                                                    </li>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.data_processing.OcrBatch.text_lengths"><code
                                                            class="docutils literal notranslate"><span class="pre">OcrBatch.text_lengths</span></code></a>
                                                    </li>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.data_processing.OcrBatch.texts"><code
                                                            class="docutils literal notranslate"><span class="pre">OcrBatch.texts</span></code></a>
                                                    </li>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.data_processing.OcrBatch.texts_tensor"><code
                                                            class="docutils literal notranslate"><span class="pre">OcrBatch.texts_tensor</span></code></a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_processing.OcrIterDataset"><code
                                                    class="docutils literal notranslate"><span class="pre">OcrIterDataset</span></code></a>
                                                <ul>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.data_processing.OcrIterDataset.distribute"><code
                                                            class="docutils literal notranslate"><span class="pre">OcrIterDataset.distribute()</span></code></a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_processing.OcrLine"><code
                                                    class="docutils literal notranslate"><span
                                                    class="pre">OcrLine</span></code></a></li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_processing.chunk_img_tensor"><code
                                                    class="docutils literal notranslate"><span class="pre">chunk_img_tensor()</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_processing.compute_n_chunks"><code
                                                    class="docutils literal notranslate"><span class="pre">compute_n_chunks()</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_processing.compute_padding"><code
                                                    class="docutils literal notranslate"><span class="pre">compute_padding()</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_processing.crop_image_tensor_to_nonzero"><code
                                                    class="docutils literal notranslate"><span class="pre">crop_image_tensor_to_nonzero()</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_processing.get_custom_dataloader"><code
                                                    class="docutils literal notranslate"><span class="pre">get_custom_dataloader()</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_processing.invert_image_tensor"><code
                                                    class="docutils literal notranslate"><span class="pre">invert_image_tensor()</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_processing.normalize_image_tensor"><code
                                                    class="docutils literal notranslate"><span class="pre">normalize_image_tensor()</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_processing.prepare_img"><code
                                                    class="docutils literal notranslate"><span
                                                    class="pre">prepare_img()</span></code></a></li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_processing.recompose_batched_chunks"><code
                                                    class="docutils literal notranslate"><span class="pre">recompose_batched_chunks()</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.data_processing.recompose_chunks"><code
                                                    class="docutils literal notranslate"><span class="pre">recompose_chunks()</span></code></a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a class="reference internal" href="#module-ajmc.ocr.pytorch.datasets">ajmc.ocr.pytorch.datasets
                                        module</a>
                                        <ul>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.datasets.OcrEvalDataset"><code
                                                    class="docutils literal notranslate"><span class="pre">OcrEvalDataset</span></code></a>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.datasets.OcrTorchDataset"><code
                                                    class="docutils literal notranslate"><span class="pre">OcrTorchDataset</span></code></a>
                                                <ul>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.datasets.OcrTorchDataset.classes_to_indices"><code
                                                            class="docutils literal notranslate"><span class="pre">OcrTorchDataset.classes_to_indices</span></code></a>
                                                    </li>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.datasets.OcrTorchDataset.indices_to_classes"><code
                                                            class="docutils literal notranslate"><span class="pre">OcrTorchDataset.indices_to_classes</span></code></a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.datasets.OcrTrainingDataset"><code
                                                    class="docutils literal notranslate"><span class="pre">OcrTrainingDataset</span></code></a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a class="reference internal" href="#module-ajmc.ocr.pytorch.model">ajmc.ocr.pytorch.model
                                        module</a>
                                        <ul>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.model.DenseNetBackbone"><code
                                                    class="docutils literal notranslate"><span class="pre">DenseNetBackbone</span></code></a>
                                                <ul>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.model.DenseNetBackbone.forward"><code
                                                            class="docutils literal notranslate"><span class="pre">DenseNetBackbone.forward()</span></code></a>
                                                    </li>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.model.DenseNetBackbone.from_config"><code
                                                            class="docutils literal notranslate"><span class="pre">DenseNetBackbone.from_config()</span></code></a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.model.OcrTorchModel"><code
                                                    class="docutils literal notranslate"><span
                                                    class="pre">OcrTorchModel</span></code></a>
                                                <ul>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.model.OcrTorchModel.forward"><code
                                                            class="docutils literal notranslate"><span class="pre">OcrTorchModel.forward()</span></code></a>
                                                    </li>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.model.OcrTorchModel.predict"><code
                                                            class="docutils literal notranslate"><span class="pre">OcrTorchModel.predict()</span></code></a>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a class="reference internal" href="#module-ajmc.ocr.pytorch.train_parallel">ajmc.ocr.pytorch.train_parallel
                                        module</a>
                                        <ul>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.train_parallel.OcrModelTrainer"><code
                                                    class="docutils literal notranslate"><span class="pre">OcrModelTrainer</span></code></a>
                                                <ul>
                                                    <li><a class="reference internal"
                                                           href="#ajmc.ocr.pytorch.train_parallel.OcrModelTrainer.train"><code
                                                            class="docutils literal notranslate"><span class="pre">OcrModelTrainer.train()</span></code></a>
                                                    </li>
                                                </ul>
                                            </li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.train_parallel.ddp_setup"><code
                                                    class="docutils literal notranslate"><span
                                                    class="pre">ddp_setup()</span></code></a></li>
                                            <li><a class="reference internal"
                                                   href="#ajmc.ocr.pytorch.train_parallel.main"><code
                                                    class="docutils literal notranslate"><span class="pre">main()</span></code></a>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>

                    </div>
                </div>
            </div>


        </aside>
    </div>
</div>
<script src="_static/documentation_options.js?v=2fea6348"></script>
<script src="_static/doctools.js?v=888ff710"></script>
<script src="_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="_static/scripts/furo.js?v=32e29ea5"></script>
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA="
        src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script>
    window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}
</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>